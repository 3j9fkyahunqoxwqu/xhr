<!DOCTYPE html><html lang="en-US"><meta charset="utf-8">
<title>XMLHttpRequest Standard</title>
<link href="http://www.whatwg.org/style/specification" rel="stylesheet">
<link href="http://resources.whatwg.org/logo-xhr.svg" rel="icon">

<div class="head">

<p><a class="logo" href="//www.whatwg.org/"><img alt="WHATWG" height="100" src="//resources.whatwg.org/logo-xhr.svg" width="100"></a>
<h1 class="head" id="xmlhttprequest-ls">XMLHttpRequest</h1>
<h2 class="no-num no-toc" id="living-standard-—-last-updated-11-november-2013">Living Standard — Last Updated 11 November 2013</h2>

<dl>
 <dt>This Version:
 <dd><a href="http://xhr.spec.whatwg.org/">http://xhr.spec.whatwg.org/</a>

 <dt>Participate:
 <dd>Send feedback to
  <a href="mailto:public-webapps@w3.org?subject==%5Bxhr%5D%20">public-webapps@w3.org</a>
  (<a href="http://lists.w3.org/Archives/Public/public-webapps/">archives</a>) or
  <a href="https://www.w3.org/Bugs/Public/enter_bug.cgi?product=WebAppsWG&amp;component=XHR">file a bug</a>
  (<a href="https://www.w3.org/Bugs/Public/buglist.cgi?product=WebAppsWG&amp;component=XHR&amp;resolution=---">open bugs</a>)

 <dd><a href="http://wiki.whatwg.org/wiki/IRC">IRC: #whatwg on Freenode</a>

 <dt>Version History:
 <dd><a href="https://github.com/whatwg/xhr/commits">https://github.com/whatwg/xhr/commits</a>

 <dt>Editor:
 <dd><a href="http://annevankesteren.nl/">Anne van Kesteren</a>
  (<a href="http://www.mozilla.org/">Mozilla</a>)
  &lt;<a href="mailto:annevk@annevk.nl">annevk@annevk.nl</a>&gt;
</dl>

<script async="" src="//resources.whatwg.org/file-bug.js"></script>

<p class="copyright"><a href="http://creativecommons.org/publicdomain/zero/1.0/" rel="license"><img alt="CC0" src="http://i.creativecommons.org/p/zero/1.0/80x15.png"></a>
To the extent possible under law, the editor has waived all copyright and
related or neighboring rights to this work. In addition, as of
11 November 2013, the editor has made this specification available
under the
<a href="http://www.openwebfoundation.org/legal/the-owf-1-0-agreements/owfa-1-0" rel="license">Open Web Foundation Agreement Version 1.0</a>,
which is available at
http://www.openwebfoundation.org/legal/the-owf-1-0-agreements/owfa-1-0.

</div>



<h2 class="no-num no-toc" id="specabstract">Abstract</h2>

<p>XMLHttpRequest defines an API that provides scripted client functionality for
transferring data between a client and a server.



<h2 class="no-num no-toc" id="toc">Table of Contents</h2>


<!--begin-toc-->
<ol class="toc">
 <li><a href="#introduction"><span class="secno">1 </span>Introduction</a>
  <ol class="toc">
   <li><a href="#specification-history"><span class="secno">1.1 </span>Specification history</a></ol></li>
 <li><a href="#conformance"><span class="secno">2 </span>Conformance</a>
  <ol class="toc">
   <li><a href="#extensibility"><span class="secno">2.1 </span>Extensibility</a></ol></li>
 <li><a href="#terminology"><span class="secno">3 </span>Terminology</a></li>
 <li><a href="#interface-xmlhttprequest"><span class="secno">4 </span>Interface <code title="">XMLHttpRequest</code></a>
  <ol class="toc">
   <li><a href="#constructors"><span class="secno">4.1 </span>Constructors</a></li>
   <li><a href="#garbage-collection"><span class="secno">4.2 </span>Garbage collection</a></li>
   <li><a href="#event-handlers"><span class="secno">4.3 </span>Event handlers</a></li>
   <li><a href="#states"><span class="secno">4.4 </span>States</a></li>
   <li><a href="#request"><span class="secno">4.5 </span>Request</a>
    <ol class="toc">
     <li><a href="#the-open()-method"><span class="secno">4.5.1 </span>The <code title="">open()</code> method</a></li>
     <li><a href="#the-setrequestheader()-method"><span class="secno">4.5.2 </span>The <code title="">setRequestHeader()</code> method</a></li>
     <li><a href="#the-timeout-attribute"><span class="secno">4.5.3 </span>The <code title="">timeout</code> attribute</a></li>
     <li><a href="#the-withcredentials-attribute"><span class="secno">4.5.4 </span>The <code title="">withCredentials</code> attribute</a></li>
     <li><a href="#the-upload-attribute"><span class="secno">4.5.5 </span>The <code title="">upload</code> attribute</a></li>
     <li><a href="#the-send()-method"><span class="secno">4.5.6 </span>The <code title="">send()</code> method</a></li>
     <li><a href="#the-abort()-method"><span class="secno">4.5.7 </span>The <code title="">abort()</code> method</a></ol></li>
   <li><a href="#response"><span class="secno">4.6 </span>Response</a>
    <ol class="toc">
     <li><a href="#the-status-attribute"><span class="secno">4.6.1 </span>The <code title="">status</code> attribute</a></li>
     <li><a href="#the-statustext-attribute"><span class="secno">4.6.2 </span>The <code title="">statusText</code> attribute</a></li>
     <li><a href="#the-getresponseheader()-method"><span class="secno">4.6.3 </span>The <code title="">getResponseHeader()</code> method</a></li>
     <li><a href="#the-getallresponseheaders()-method"><span class="secno">4.6.4 </span>The <code title="">getAllResponseHeaders()</code> method</a></li>
     <li><a href="#response-entity-body-0"><span class="secno">4.6.5 </span>Response entity body</a></li>
     <li><a href="#the-overridemimetype()-method"><span class="secno">4.6.6 </span>The <code title="">overrideMimeType()</code> method</a></li>
     <li><a href="#the-responsetype-attribute"><span class="secno">4.6.7 </span>The <code title="">responseType</code> attribute</a></li>
     <li><a href="#the-response-attribute"><span class="secno">4.6.8 </span>The <code title="">response</code> attribute</a></li>
     <li><a href="#the-responsetext-attribute"><span class="secno">4.6.9 </span>The <code title="">responseText</code> attribute</a></li>
     <li><a href="#the-responsexml-attribute"><span class="secno">4.6.10 </span>The <code title="">responseXML</code> attribute</a></ol></li>
   <li><a href="#events"><span class="secno">4.7 </span>Events summary</a></ol></li>
 <li><a href="#interface-formdata"><span class="secno">5 </span>Interface <code title="">FormData</code></a></li>
 <li><a href="#interface-progressevent"><span class="secno">6 </span>Interface <code title="">ProgressEvent</code></a>
  <ol class="toc">
   <li><a href="#firing-events-using-the-progressevent-interface-for-fetch"><span class="secno">6.1 </span>Firing events using the <code title="">ProgressEvent</code> interface for Fetch</a></li>
   <li><a href="#firing-events-using-the-progressevent-interface-for-other-contexts"><span class="secno">6.2 </span>Firing events using the <code title="">ProgressEvent</code> interface for other contexts</a></li>
   <li><a href="#suggested-names-for-events-using-the-progressevent-interface"><span class="secno">6.3 </span>Suggested names for events using the <code title="">ProgressEvent</code> interface</a></li>
   <li><a href="#security-considerations"><span class="secno">6.4 </span>Security Considerations</a></li>
   <li><a href="#example"><span class="secno">6.5 </span>Example</a></ol></li>
 <li><a class="no-num" href="#references">References</a></li>
 <li><a class="no-num" href="#acknowledgments">Acknowledgments</a></ol>
<!--end-toc-->



<h2 id="introduction"><span class="secno">1 </span>Introduction</h2>

<p><em>This section is non-normative.</em>

<p>The <code><a href="#xmlhttprequest">XMLHttpRequest</a></code> object is an API for
<a class="external" href="http://fetch.spec.whatwg.org/#concept-fetch" title="concept-fetch">fetching</a> resources.

<p>The name <code><a href="#xmlhttprequest">XMLHttpRequest</a></code> is historical and has no baring on its
functionality.

<div class="example">
 <p>Some simple code to do something with data from an XML document
 fetched over the network:

 <pre><code>function processData(data) {
  // taking care of data
}

function handler() {
  if(this.readyState == this.DONE) {
    if(this.status == 200 &amp;&amp;
       this.responseXML != null &amp;&amp;
       this.responseXML.getElementById('test').textContent) {
      // success!
      processData(this.responseXML.getElementById('test').textContent);
      return;
    }
    // something went wrong
    processData(null);
  }
}

var client = new XMLHttpRequest();
client.onreadystatechange = handler;
client.open("GET", "unicorn.xml");
client.send();</code></pre>

 <p>If you just want to log a message to the server:

 <pre><code>function log(message) {
  var client = new XMLHttpRequest();
  client.open("POST", "/log");
  client.setRequestHeader("Content-Type", "text/plain;charset=UTF-8");
  client.send(message);
}</code></pre>

 <p>Or if you want to check the status of a document on the server:

 <pre><code>function fetchStatus(address) {
  var client = new XMLHttpRequest();
  client.onreadystatechange = function() {
    // in case of network errors this might not give reliable results
    if(this.readyState == this.DONE)
      returnStatus(this.status);
  }
  client.open("HEAD", address);
  client.send();
}</code></pre>
</div>


<h3 id="specification-history"><span class="secno">1.1 </span>Specification history</h3>

<p>The <code><a href="#xmlhttprequest">XMLHttpRequest</a></code> object was initially defined as part of
the WHATWG's HTML effort. (Long after Microsoft shipped an implementation.)
It moved to the W3C in 2006. Extensions (e.g. progress events and
cross-origin requests) to <code><a href="#xmlhttprequest">XMLHttpRequest</a></code> were developed in a
separate draft (XMLHttpRequest Level 2) until end of 2011, at which point
the two drafts were merged and <code><a href="#xmlhttprequest">XMLHttpRequest</a></code> became a single
entity again from a standards perspective. End of 2012 it moved back to the
WHATWG.

<p>Historical discussion can be found in the following mailing list
archives:

<ul>
 <li><a href="http://lists.whatwg.org/htdig.cgi/whatwg-whatwg.org/">whatwg@whatwg.org</a>
 <li><a href="http://lists.w3.org/Archives/Public/public-webapi/">public-webapi@w3.org</a>
 <li><a href="http://lists.w3.org/Archives/Public/public-appformats/">public-appformats@w3.org</a>
 <li><a href="http://lists.w3.org/Archives/Public/public-webapps/">public-webapps@w3.org</a>
</ul>



<h2 id="conformance"><span class="secno">2 </span>Conformance</h2>

<p>All diagrams, examples, and notes in this specification are
non-normative, as are all sections explicitly marked non-normative.
Everything else in this specification is normative.

<p>The key words "MUST", "MUST NOT", "REQUIRED", <!--"SHALL", "SHALL
NOT",--> "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and
"OPTIONAL" in the normative parts of this specification are to be
interpreted as described in RFC2119. For readability, these words do
not appear in all uppercase letters in this specification.
<a href="#refsRFC2119">[RFC2119]</a>


<h3 id="extensibility"><span class="secno">2.1 </span>Extensibility</h3>

<p>User agents, Working Groups, and other interested parties are
<em>strongly encouraged</em> to discuss new features with the WHATWG
community.



<h2 id="terminology"><span class="secno">3 </span>Terminology</h2>

<p>This specification uses terminology, cross-linked throughout, from DOM,
DOM Parsing and Serialization, Encoding, Fetch, File API, HTML, HTTP, Typed Array, URL,
Web IDL, and XML.

<a href="#refsDOM">[DOM]</a>
<a href="#refsDOMPS">[DOMPS]</a>
<a href="#refsENCODING">[ENCODING]</a>
<a href="#refsFETCH">[FETCH]</a>
<a href="#refsFILEAPI">[FILEAPI]</a>
<a href="#refsHTML">[HTML]</a>
<a href="#refsHTTP">[HTTP]</a>
<a href="#refsTYPEDARRAY">[TYPEDARRAY]</a>
<a href="#refsURL">[URL]</a>
<a href="#refsWEBIDL">[WEBIDL]</a>
<a href="#refsXML">[XML]</a> <a href="#refsXMLNS">[XMLNS]</a>

<p>It uses the typographic conventions from HTML. <a href="#refsHTTP">[HTTP]</a>

<p>The term <dfn id="user-credentials">user credentials</dfn> for the purposes of this
specification means cookies, HTTP authentication, and client-side SSL
certificates. Specifically it does not refer to proxy authentication or the
<code title="http-origin">Origin</code> header.
<a href="#refsCOOKIES">[COOKIES]</a> <!-- XXX ref? -->



<h2 id="interface-xmlhttprequest"><span class="secno">4 </span>Interface <code title="">XMLHttpRequest</code></h2>

<pre class="idl">[NoInterfaceObject]
interface <dfn id="xmlhttprequesteventtarget">XMLHttpRequestEventTarget</dfn> : <a class="external" href="http://dom.spec.whatwg.org/#eventtarget">EventTarget</a> {
  // <a href="#event-handlers">event handlers</a>
  attribute <a class="external" href="http://www.whatwg.org/specs/web-apps/current-work/multipage/webappapis.html#eventhandler">EventHandler</a> <a href="#handler-xhr-onloadstart" title="handler-xhr-onloadstart">onloadstart</a>;
  attribute <a class="external" href="http://www.whatwg.org/specs/web-apps/current-work/multipage/webappapis.html#eventhandler">EventHandler</a> <a href="#handler-xhr-onprogress" title="handler-xhr-onprogress">onprogress</a>;
  attribute <a class="external" href="http://www.whatwg.org/specs/web-apps/current-work/multipage/webappapis.html#eventhandler">EventHandler</a> <a href="#handler-xhr-onabort" title="handler-xhr-onabort">onabort</a>;
  attribute <a class="external" href="http://www.whatwg.org/specs/web-apps/current-work/multipage/webappapis.html#eventhandler">EventHandler</a> <a href="#handler-xhr-onerror" title="handler-xhr-onerror">onerror</a>;
  attribute <a class="external" href="http://www.whatwg.org/specs/web-apps/current-work/multipage/webappapis.html#eventhandler">EventHandler</a> <a href="#handler-xhr-onload" title="handler-xhr-onload">onload</a>;
  attribute <a class="external" href="http://www.whatwg.org/specs/web-apps/current-work/multipage/webappapis.html#eventhandler">EventHandler</a> <a href="#handler-xhr-ontimeout" title="handler-xhr-ontimeout">ontimeout</a>;
  attribute <a class="external" href="http://www.whatwg.org/specs/web-apps/current-work/multipage/webappapis.html#eventhandler">EventHandler</a> <a href="#handler-xhr-onloadend" title="handler-xhr-onloadend">onloadend</a>;
};

interface <dfn id="xmlhttprequestupload">XMLHttpRequestUpload</dfn> : <a href="#xmlhttprequesteventtarget">XMLHttpRequestEventTarget</a> {
};

enum <dfn id="xmlhttprequestresponsetype">XMLHttpRequestResponseType</dfn> {
  "",
  "arraybuffer",
  "blob",
  "document",
  "json",
  "text"
};

[<a href="#dom-xmlhttprequest" title="dom-XMLHttpRequest">Constructor</a>]
interface <dfn id="xmlhttprequest">XMLHttpRequest</dfn> : <a href="#xmlhttprequesteventtarget">XMLHttpRequestEventTarget</a> {
  // <a href="#event-handlers">event handler</a>
  attribute <a class="external" href="http://www.whatwg.org/specs/web-apps/current-work/multipage/webappapis.html#eventhandler">EventHandler</a> <a href="#handler-xhr-onreadystatechange" title="handler-xhr-onreadystatechange">onreadystatechange</a>;

  // <a href="#states">states</a>
  const unsigned short <a href="#dom-xmlhttprequest-unsent" title="dom-XMLHttpRequest-UNSENT">UNSENT</a> = 0;
  const unsigned short <a href="#dom-xmlhttprequest-opened" title="dom-XMLHttpRequest-OPENED">OPENED</a> = 1;
  const unsigned short <a href="#dom-xmlhttprequest-headers_received" title="dom-XMLHttpRequest-HEADERS_RECEIVED">HEADERS_RECEIVED</a> = 2;
  const unsigned short <a href="#dom-xmlhttprequest-loading" title="dom-XMLHttpRequest-LOADING">LOADING</a> = 3;
  const unsigned short <a href="#dom-xmlhttprequest-done" title="dom-XMLHttpRequest-DONE">DONE</a> = 4;
  readonly attribute unsigned short <a href="#dom-xmlhttprequest-readystate" title="dom-XMLHttpRequest-readyState">readyState</a>;

  // <a href="#request">request</a>
  void <a href="#dom-xmlhttprequest-open" title="dom-XMLHttpRequest-open">open</a>(ByteString <var>method</var>, [EnsureUTF16] DOMString <var title="">url</var>);
  void <a href="#dom-xmlhttprequest-open" title="dom-XMLHttpRequest-open">open</a>(ByteString <var>method</var>, [EnsureUTF16] DOMString <var title="">url</var>, boolean <var>async</var>, optional [EnsureUTF16] DOMString? <var>username</var> = null, optional [EnsureUTF16] DOMString? <var>password</var> = null);
  void <a href="#dom-xmlhttprequest-setrequestheader" title="dom-XMLHttpRequest-setRequestHeader">setRequestHeader</a>(ByteString <var>name</var>, ByteString <var>value</var>);
           attribute unsigned long <a href="#dom-xmlhttprequest-timeout" title="dom-XMLHttpRequest-timeout">timeout</a>;
           attribute boolean <a href="#dom-xmlhttprequest-withcredentials" title="dom-XMLHttpRequest-withCredentials">withCredentials</a>;
  readonly attribute <a href="#xmlhttprequestupload">XMLHttpRequestUpload</a> <a href="#dom-xmlhttprequest-upload" title="dom-XMLHttpRequest-upload">upload</a>;
  void <a href="#dom-xmlhttprequest-send" title="dom-XMLHttpRequest-send">send</a>(optional (<a class="external" href="http://www.khronos.org/registry/typedarray/specs/latest/#6">ArrayBufferView</a> or <a class="external" href="http://dev.w3.org/2006/webapi/FileAPI/#blob">Blob</a> or <a class="external" href="http://dom.spec.whatwg.org/#document">Document</a> or [EnsureUTF16] DOMString or <a href="#formdata">FormData</a> or <a class="external" href="http://url.spec.whatwg.org/#urlsearchparams">URLSearchParams</a>)? <var>data</var> = null);
  void <a href="#dom-xmlhttprequest-abort" title="dom-XMLHttpRequest-abort">abort</a>();

  // <a href="#response">response</a>
  readonly attribute unsigned short <a href="#dom-xmlhttprequest-status" title="dom-XMLHttpRequest-status">status</a>;
  readonly attribute ByteString <a href="#dom-xmlhttprequest-statustext" title="dom-XMLHttpRequest-statusText">statusText</a>;
  ByteString? <a href="#dom-xmlhttprequest-getresponseheader" title="dom-XMLHttpRequest-getResponseHeader">getResponseHeader</a>(ByteString <var>name</var>);
  ByteString <a href="#dom-xmlhttprequest-getallresponseheaders" title="dom-XMLHttpRequest-getAllResponseHeaders">getAllResponseHeaders</a>();
  void <a href="#dom-xmlhttprequest-overridemimetype" title="dom-XMLHttpRequest-overrideMimeType">overrideMimeType</a>(DOMString <var>mime</var>);
           attribute <a href="#xmlhttprequestresponsetype">XMLHttpRequestResponseType</a> <a href="#dom-xmlhttprequest-responsetype" title="dom-XMLHttpRequest-responseType">responseType</a>;
  readonly attribute any <a href="#dom-xmlhttprequest-response" title="dom-XMLHttpRequest-response">response</a>;
  readonly attribute DOMString <a href="#dom-xmlhttprequest-responsetext" title="dom-XMLHttpRequest-responseText">responseText</a>;
  readonly attribute <a class="external" href="http://dom.spec.whatwg.org/#document">Document</a>? <a href="#dom-xmlhttprequest-responsexml" title="dom-XMLHttpRequest-responseXML">responseXML</a>;
};</pre>

<p>Each <code><a href="#xmlhttprequest">XMLHttpRequest</a></code> object has a unique, associated
<code><a href="#xmlhttprequestupload">XMLHttpRequestUpload</a></code> object.

<p>If the <a class="external" href="http://www.whatwg.org/specs/web-apps/current-work/multipage/infrastructure.html#javascript-global-environment">JavaScript global environment</a> is a
<a class="external" href="http://www.whatwg.org/specs/web-apps/current-work/multipage/webappapis.html#worker-environment">worker environment</a>, implementations must act as if
<code title="">Document</code> and <code title="">Document?</code> in the above IDL were not
exposed. I.e. <code title="dom-XMLHttpRequest-send"><a href="#dom-xmlhttprequest-send">send()</a></code> is not overloaded with it
and <code title="dom-XMLHttpRequest-responseXML"><a href="#dom-xmlhttprequest-responsexml">responseXML</a></code> always returns null (as
required by its definition, too).


<h3 id="constructors"><span class="secno">4.1 </span>Constructors</h3>

<p>When the <a class="external" href="http://www.whatwg.org/specs/web-apps/current-work/multipage/infrastructure.html#javascript-global-environment">JavaScript global environment</a>
is a <a class="external" href="http://www.whatwg.org/specs/web-apps/current-work/multipage/webappapis.html#document-environment">document environment</a>, the
<code><a href="#xmlhttprequest">XMLHttpRequest</a></code> object has an associated
<dfn id="concept-xmlhttprequest-document" title="concept-XMLHttpRequest-document">document</dfn>.

<dl class="domintro">
 <dt><code><var title="">client</var> = new <a href="#dom-xmlhttprequest" title="dom-XMLHttpRequest">XMLHttpRequest</a>()</code>
 <dd>Returns a new <code><a href="#xmlhttprequest">XMLHttpRequest</a></code> object.
</dl>

<p>The
<dfn id="dom-xmlhttprequest" title="dom-XMLHttpRequest"><code>XMLHttpRequest()</code></dfn>
constructor must run these steps:

<ol>
 <li><p>Let <var title="">xhr</var> be a new <code><a href="#xmlhttprequest">XMLHttpRequest</a></code>
 object.

 <li><p>If the
 <a class="external" href="http://www.whatwg.org/specs/web-apps/current-work/multipage/infrastructure.html#javascript-global-environment">JavaScript global environment</a> is a
 <a class="external" href="http://www.whatwg.org/specs/web-apps/current-work/multipage/webappapis.html#document-environment">document environment</a>, set <var title="">xhr</var>'s
 <a href="#concept-xmlhttprequest-document" title="concept-XMLHttpRequest-document">document</a> to the
 <a class="external" href="http://dom.spec.whatwg.org/#concept-document" title="concept-document">document</a>
 associated with the global object of <var title="">xhr</var>'s interface
 object.

 <li><p>Return <var title="">xhr</var>.
</ol>


<h3 id="garbage-collection"><span class="secno">4.2 </span>Garbage collection</h3>
<!-- Based on EventSource and WebSocket. Not sure what I am doing. -->

<p>An <code><a href="#xmlhttprequest">XMLHttpRequest</a></code> object must not be garbage collected if
its state is <a href="#dom-xmlhttprequest-opened" title="dom-XMLHttpRequest-OPENED">OPENED</a> and the
<a href="#send-flag"><code>send()</code> flag</a> is set, its state is
<a href="#dom-xmlhttprequest-headers_received" title="dom-XMLHttpRequest-HEADERS_RECEIVED">HEADERS_RECEIVED</a>, or
its state is <a href="#dom-xmlhttprequest-loading" title="dom-XMLHttpRequest-LOADING">LOADING</a>, and
one of the following is true:

<ul>
 <li><p>It has one or more
 <a class="external" href="http://dom.spec.whatwg.org/#concept-event-listener" title="concept-event-listener">event listeners</a>
 registered whose <b>type</b> is
 <code title="event-xhr-readystatechange"><a href="#event-xhr-readystatechange">readystatechange</a></code>,
 <code title="event-xhr-progress"><a href="#event-xhr-progress">progress</a></code>,
 <code title="event-xhr-abort"><a href="#event-xhr-abort">abort</a></code>,
 <code title="event-xhr-error"><a href="#event-xhr-error">error</a></code>,
 <code title="event-xhr-load"><a href="#event-xhr-load">load</a></code>,
 <code title="event-xhr-timeout"><a href="#event-xhr-timeout">timeout</a></code>, or
 <code title="event-xhr-loadend"><a href="#event-xhr-loadend">loadend</a></code>.
 <li><p>The <a href="#upload-complete-flag">upload complete flag</a> is unset and the associated
 <code><a href="#xmlhttprequestupload">XMLHttpRequestUpload</a></code> object has one or more
 <a class="external" href="http://dom.spec.whatwg.org/#concept-event-listener" title="concept-event-listener">event listeners</a>
 registered whose <b>type</b> is
 <code title="event-xhr-progress"><a href="#event-xhr-progress">progress</a></code>,
 <code title="event-xhr-abort"><a href="#event-xhr-abort">abort</a></code>,
 <code title="event-xhr-error"><a href="#event-xhr-error">error</a></code>,
 <code title="event-xhr-load"><a href="#event-xhr-load">load</a></code>,
 <code title="event-xhr-timeout"><a href="#event-xhr-timeout">timeout</a></code>, or
 <code title="event-xhr-loadend"><a href="#event-xhr-loadend">loadend</a></code>.
</ul>

<p>If an <code><a href="#xmlhttprequest">XMLHttpRequest</a></code> object is garbage collected while its
connection is still open, the user agent must <a href="#terminate-the-request">terminate the request</a>.


<h3 id="event-handlers"><span class="secno">4.3 </span>Event handlers</h3>

<p>The following are the
<a class="external" href="http://www.whatwg.org/specs/web-apps/current-work/multipage/webappapis.html#event-handlers">event handlers</a> (and their corresponding
<a class="external" href="http://www.whatwg.org/specs/web-apps/current-work/multipage/webappapis.html#event-handler-event-type" title="event handler event type">event handler event types</a>)
that must be supported on objects implementing an interface that inherits
from <code><a href="#xmlhttprequesteventtarget">XMLHttpRequestEventTarget</a></code> as attributes:

<table>
 <thead>
  <tr>
   <th><a class="external" href="http://www.whatwg.org/specs/web-apps/current-work/multipage/webappapis.html#event-handlers" title="event handlers">event handler</a>
   <th><a class="external" href="http://www.whatwg.org/specs/web-apps/current-work/multipage/webappapis.html#event-handler-event-type">event handler event type</a>
 <tbody>
  <tr>
   <td><dfn id="handler-xhr-onloadstart" title="handler-xhr-onloadstart"><code>onloadstart</code></dfn>
   <td><code title="event-xhr-loadstart"><a href="#event-xhr-loadstart">loadstart</a></code>
  <tr>
   <td><dfn id="handler-xhr-onprogress" title="handler-xhr-onprogress"><code>onprogress</code></dfn>
   <td><code title="event-xhr-progress"><a href="#event-xhr-progress">progress</a></code>
  <tr>
   <td><dfn id="handler-xhr-onabort" title="handler-xhr-onabort"><code>onabort</code></dfn>
   <td><code title="event-xhr-abort"><a href="#event-xhr-abort">abort</a></code>
  <tr>
   <td><dfn id="handler-xhr-onerror" title="handler-xhr-onerror"><code>onerror</code></dfn>
   <td><code title="event-xhr-error"><a href="#event-xhr-error">error</a></code>
  <tr>
   <td><dfn id="handler-xhr-onload" title="handler-xhr-onload"><code>onload</code></dfn>
   <td><code title="event-xhr-load"><a href="#event-xhr-load">load</a></code>
  <tr>
   <td><dfn id="handler-xhr-ontimeout" title="handler-xhr-ontimeout"><code>ontimeout</code></dfn>
   <td><code title="event-xhr-timeout"><a href="#event-xhr-timeout">timeout</a></code>
  <tr>
   <td><dfn id="handler-xhr-onloadend" title="handler-xhr-onloadend"><code>onloadend</code></dfn>
   <td><code title="event-xhr-loadend"><a href="#event-xhr-loadend">loadend</a></code>
</table>

<p>The following is the
<a class="external" href="http://www.whatwg.org/specs/web-apps/current-work/multipage/webappapis.html#event-handlers" title="event handlers">event handler</a>
(and its corresponding
<a class="external" href="http://www.whatwg.org/specs/web-apps/current-work/multipage/webappapis.html#event-handler-event-type">event handler event type</a>) that must be
supported as attribute solely by the
<code><a href="#xmlhttprequest">XMLHttpRequest</a></code> object:

<table>
 <thead>
  <tr>
   <th><a class="external" href="http://www.whatwg.org/specs/web-apps/current-work/multipage/webappapis.html#event-handlers" title="event handlers">event handler</a>
   <th><a class="external" href="http://www.whatwg.org/specs/web-apps/current-work/multipage/webappapis.html#event-handler-event-type">event handler event type</a>
 <tbody>
  <tr>
   <td><dfn id="handler-xhr-onreadystatechange" title="handler-xhr-onreadystatechange"><code>onreadystatechange</code></dfn>
   <td><code title="event-xhr-readystatechange"><a href="#event-xhr-readystatechange">readystatechange</a></code></td>
</table>


<h3 id="states"><span class="secno">4.4 </span>States</h3>

<dl class="domintro">
 <dt><code><var title="">client</var> . <a href="#dom-xmlhttprequest-readystate" title="dom-XMLHttpRequest-readyState">readyState</a></code>
 <dd><p>Returns the current state.
</dl>

<p>The <code><a href="#xmlhttprequest">XMLHttpRequest</a></code> object can be in several states. The
<dfn id="dom-xmlhttprequest-readystate" title="dom-XMLHttpRequest-readyState"><code>readyState</code></dfn>
attribute must return the current state, which must be one of the
following values:

<dl>
 <dt><dfn id="dom-xmlhttprequest-unsent" title="dom-XMLHttpRequest-UNSENT"><code>UNSENT</code></dfn>
 (numeric value 0)</dt>
 <dd><p>The object has been constructed.</dd>

 <dt><dfn id="dom-xmlhttprequest-opened" title="dom-XMLHttpRequest-OPENED"><code>OPENED</code></dfn>
 (numeric value 1)</dt>
 <dd><p>The <code title="dom-XMLHttpRequest-open"><a href="#dom-xmlhttprequest-open">open()</a></code> method has been successfully invoked.
 During this state request headers can be set using
 <code title="dom-XMLHttpRequest-setRequestHeader"><a href="#dom-xmlhttprequest-setrequestheader">setRequestHeader()</a></code>
 and the request can be made using the
 <code title="dom-XMLHttpRequest-send"><a href="#dom-xmlhttprequest-send">send()</a></code> method.</dd>

 <dt><dfn id="dom-xmlhttprequest-headers_received" title="dom-XMLHttpRequest-HEADERS_RECEIVED"><code>HEADERS_RECEIVED</code></dfn>
 (numeric value 2)</dt>
 <dd><p>All redirects (if any) have been followed and all HTTP headers of
 the final response have been received. Several response members of the
 object are now available.</dd>

 <dt><dfn id="dom-xmlhttprequest-loading" title="dom-XMLHttpRequest-LOADING"><code>LOADING</code></dfn>
 (numeric value 3)</dt>
 <dd><p>The <a href="#response-entity-body">response entity body</a> is being received.</dd>

 <dt><dfn id="dom-xmlhttprequest-done" title="dom-XMLHttpRequest-DONE"><code>DONE</code></dfn>
 (numeric value 4)</dt>
 <dd><p>The data transfer has been completed or something went wrong
 during the transfer (e.g. infinite redirects).</dd>
</dl>

<p>The <dfn id="send-flag"><code>send()</code> flag</dfn> indicates
that the <code title="dom-XMLHttpRequest-send"><a href="#dom-xmlhttprequest-send">send()</a></code> method has
been invoked. It is initially unset and is used during the
<a href="#dom-xmlhttprequest-opened" title="dom-XMLHttpRequest-OPENED">OPENED</a> state.



<h3 id="request"><span class="secno">4.5 </span>Request</h3>

<p>Each <code><a href="#xmlhttprequest">XMLHttpRequest</a></code> object has the following
request-associated concepts:

<dfn id="request-method">request method</dfn>,
<dfn id="request-url">request URL</dfn>,
<dfn id="author-request-headers">author request headers</dfn>,
<dfn id="request-entity-body">request entity body</dfn>,
<dfn id="source-origin">source origin</dfn>,
<dfn id="referrer-source">referrer source</dfn>,
<dfn id="synchronous-flag">synchronous flag</dfn>,
<dfn id="upload-complete-flag">upload complete flag</dfn>, and
<dfn id="upload-events-flag">upload events flag</dfn>.

<p>The <a href="#author-request-headers">author request headers</a> is an initially empty list of
<a class="external" href="http://fetch.spec.whatwg.org/#concept-header" title="concept-header">headers</a>.

<p>The <a href="#request-entity-body">request entity body</a> is initially null.

<p>The <a href="#synchronous-flag">synchronous flag</a>,
<a href="#upload-complete-flag">upload complete flag</a>, and
<a href="#upload-events-flag">upload events flag</a> are initially unset.

<hr>

<p>To <dfn id="terminate-the-request">terminate the request</dfn>,
<a class="external" href="http://fetch.spec.whatwg.org/#concept-fetch-terminate" title="concept-fetch-terminate">terminate</a> the
<a class="external" href="http://fetch.spec.whatwg.org/#concept-fetch" title="concept-fetch">fetch</a> algorithm operated by the
<code><a href="#xmlhttprequest">XMLHttpRequest</a></code> object with reason <i title="">fatal</i>.



<h4 id="the-open()-method"><span class="secno">4.5.1 </span>The <code title="">open()</code> method</h4>

<dl class="domintro">
 <dt><code><var title="">client</var> . <a href="#dom-xmlhttprequest-open" title="dom-XMLHttpRequest-open">open</a>(<var title="">method</var>, <var title="">url</var> [, <var title="">async</var> = true [, <var title="">username</var> = null [, <var title="">password</var> = null]]])</code>

 <dd>
  <p>Sets the <a href="#request-method">request method</a>, <a href="#request-url">request URL</a>, and
  <a href="#synchronous-flag">synchronous flag</a>.

  <p>Throws a "<code class="external"><a href="http://dom.spec.whatwg.org/#syntaxerror">SyntaxError</a></code>" exception if
  either <var title="">method</var> is not a valid HTTP method or
  <var title="">url</var> cannot be parsed.

  <p>Throws a "<code class="external"><a href="http://dom.spec.whatwg.org/#securityerror">SecurityError</a></code>" exception
  if <var title="">method</var> is a case-insensitive match for
  `<code title="">CONNECT</code>`, `<code title="">TRACE</code>` or `<code title="">TRACK</code>`.

  <p>Throws an "<code class="external"><a href="http://dom.spec.whatwg.org/#invalidaccesserror">InvalidAccessError</a></code>"
  exception if <var title="">async</var> is false, the
  <a class="external" href="http://www.whatwg.org/specs/web-apps/current-work/multipage/infrastructure.html#javascript-global-environment">JavaScript global environment</a> is a
  <a class="external" href="http://www.whatwg.org/specs/web-apps/current-work/multipage/webappapis.html#document-environment">document environment</a>, and either the
  <code title="dom-XMLHttpRequest-timeout"><a href="#dom-xmlhttprequest-timeout">timeout</a></code> attribute is not
  zero, the
  <code title="dom-XMLHttpRequest-withCredentials"><a href="#dom-xmlhttprequest-withcredentials">withCredentials</a></code>
  attribute is true, or the
  <code title="dom-XMLHttpRequest-responseType"><a href="#dom-xmlhttprequest-responsetype">responseType</a></code>
  attribute is not the empty string.
</dl>

<p>The
<dfn id="dom-xmlhttprequest-open" title="dom-XMLHttpRequest-open"><code>open(<var title="">method</var>, <var title="">url</var>, <var title="">async</var>, <var title="">username</var>, <var title="">password</var>)</code></dfn>
method must run these steps:

<ol>
 <li><p>Let <var title="">base</var> be null.

 <li>
  <p>If the <a class="external" href="http://www.whatwg.org/specs/web-apps/current-work/multipage/infrastructure.html#javascript-global-environment">JavaScript global environment</a> is a
  <a class="external" href="http://www.whatwg.org/specs/web-apps/current-work/multipage/webappapis.html#document-environment">document environment</a>, run these steps:

  <ol>
   <li><p>If <a href="#concept-xmlhttprequest-document" title="concept-XMLHttpRequest-document">document</a> is not
   <a class="external" href="http://www.whatwg.org/specs/web-apps/current-work/multipage/browsers.html#fully-active">fully active</a>,
   <a class="external" href="http://dom.spec.whatwg.org/#concept-throw" title="concept-throw">throw</a> an
   "<code class="external"><a href="http://dom.spec.whatwg.org/#invalidstateerror">InvalidStateError</a></code>" exception.

   <li><p>Set <var title="">base</var> to the
   <a class="external" href="http://www.whatwg.org/specs/web-apps/current-work/multipage/urls.html#document-base-url">document base URL</a> of
   <a href="#concept-xmlhttprequest-document" title="concept-XMLHttpRequest-document">document</a>.

   <li><p>Set <a href="#source-origin">source origin</a> to the <a class="external" href="http://www.whatwg.org/specs/web-apps/current-work/multipage/origin-0.html#origin">origin</a>
   of <a href="#concept-xmlhttprequest-document" title="concept-XMLHttpRequest-document">document</a> otherwise.

   <li><p>Set <a href="#referrer-source">referrer source</a> to
   <a href="#concept-xmlhttprequest-document" title="concept-XMLHttpRequest-document">document</a>.
  </ol>

 <li>
  <p>If the <a class="external" href="http://www.whatwg.org/specs/web-apps/current-work/multipage/infrastructure.html#javascript-global-environment">JavaScript global environment</a> is a
  <a class="external" href="http://www.whatwg.org/specs/web-apps/current-work/multipage/webappapis.html#worker-environment">worker environment</a>, run these steps:

  <ol>
   <li><p>Set <var title="">base</var> to the
   <a class="external" href="http://www.whatwg.org/specs/web-apps/current-work/multipage/webappapis.html#script's-base-url">script's base URL</a>.

   <li><p>Set <a href="#source-origin">source origin</a> to the
   <a class="external" href="http://www.whatwg.org/specs/web-apps/current-work/multipage/webappapis.html#concept-script" title="concept-script">script</a>'s
   <a class="external" href="http://www.whatwg.org/specs/web-apps/current-work/multipage/origin-0.html#origin">origin</a>.

   <li><p>Set <a href="#referrer-source">referrer source</a> to the
   <a class="external" href="http://www.whatwg.org/specs/web-apps/current-work/multipage/webappapis.html#script's-referrer-source">script's referrer source</a>.
  </ol>

 <li><p>If <var>method</var> does not match the <a class="external" href="http://tools.ietf.org/html/rfc2616/#section-5.1.1">Method</a>
 token production, <a class="external" href="http://dom.spec.whatwg.org/#concept-throw" title="concept-throw">throw</a> a
 "<code class="external"><a href="http://dom.spec.whatwg.org/#syntaxerror">SyntaxError</a></code>" exception.

 <li><p>If <var>method</var> is a
 <a class="external" href="http://fetch.spec.whatwg.org/#concept-forbidden-methods" title="concept-forbidden-methods">forbidden method</a>,
 <a class="external" href="http://dom.spec.whatwg.org/#concept-throw" title="concept-throw">throw</a> a
 "<code class="external"><a href="http://dom.spec.whatwg.org/#securityerror">SecurityError</a></code>" exception.

 <li>
  <p>If <var>method</var> is a case-insensitive match for `<code title="">DELETE</code>`,
  `<code title="">GET</code>`, `<code title="">HEAD</code>`, `<code title="">OPTIONS</code>`,
  `<code title="">POST</code>`, or `<code title="">PUT</code>`, subtract
  0x20 from each byte in the range 0x61 (ASCII a) to 0x7A (ASCII z).

  <p class="note">If it does not match any of the above, it is passed
  through <em>literally</em>, including in the final request.
  <!-- WebKit (and supposedly Gecko) also uppercase: COPY, INDEX, LOCK,
  M-POST, MKCOL, MOVE, PROPFIND, PROPPATCH, and UNLOCK. -->

 <li><p>Let <var title="">parsed URL</var> be the result of
 <a class="external" href="http://url.spec.whatwg.org/#concept-url-parser" title="concept-url-parser">parsing</a> <var title="">url</var>
 with <var title="">base</var>.

 <li><p>If <var title="">parsed URL</var> is failure,
 <a class="external" href="http://dom.spec.whatwg.org/#concept-throw" title="concept-throw">throw</a> a
 "<code class="external"><a href="http://dom.spec.whatwg.org/#syntaxerror">SyntaxError</a></code>" exception.

 <li>
  <p>If the <var>async</var> argument is omitted, set <var>async</var> to true, and set
  <var title="">username</var> and <var title="">password</var> to null.

  <p class="note">Due to unfortunate legacy constraints, passing
  <code title="">undefined</code> for the <var>async</var> argument is treated differently
  from <var>async</var> being omitted.

 <li>
  <p>If <var title="">parsed URL</var>'s <a class="external" href="http://url.spec.whatwg.org/#relative-flag">relative flag</a> is
  set, run these substeps:

  <ol>
   <li><p>If the <var title="">username</var> argument is not null, set
   <var title="">parsed URL</var>'s
   <a class="external" href="http://url.spec.whatwg.org/#concept-url-username" title="concept-url-username">username</a> to
   <var>username</var>.

   <li><p>If the <var title="">password</var> argument is not null, set
   <var title="">parsed URL</var>'s
   <a class="external" href="http://url.spec.whatwg.org/#concept-url-password" title="concept-url-password">password</a> to
   <var>password</var>.
  </ol>

 <li><p>If <var>async</var> is false, the
 <a class="external" href="http://www.whatwg.org/specs/web-apps/current-work/multipage/infrastructure.html#javascript-global-environment">JavaScript global environment</a> is a
 <a class="external" href="http://www.whatwg.org/specs/web-apps/current-work/multipage/webappapis.html#document-environment">document environment</a>, and either the
 <code title="dom-XMLHttpRequest-timeout"><a href="#dom-xmlhttprequest-timeout">timeout</a></code> attribute value is not zero, the
 <code title="dom-XMLHttpRequest-withCredentials"><a href="#dom-xmlhttprequest-withcredentials">withCredentials</a></code> attribute value is
 true, or the <code title="dom-XMLHttpRequest-responseType"><a href="#dom-xmlhttprequest-responsetype">responseType</a></code> attribute
 value is not the empty string,
 <a class="external" href="http://dom.spec.whatwg.org/#concept-throw" title="concept-throw">throw</a> an
 "<code class="external"><a href="http://dom.spec.whatwg.org/#invalidaccesserror">InvalidAccessError</a></code>" exception.

 <li>
  <p><a href="#terminate-the-request">Terminate the request</a>.

  <p class="note">After all, a request can be ongoing at this point.

 <li>
  <p>Set variables associated with the object as follows:

  <ul>
   <li><p>Set <a href="#request-method">request method</a> to <var>method</var>.
   <li><p>Set <a href="#request-url">request URL</a> to <var title="">parsed URL</var>.
   <li><p>Set the <a href="#synchronous-flag">synchronous flag</a>, if <var>async</var> is false, and unset
   the <a href="#synchronous-flag">synchronous flag</a> otherwise.
   <li><p>Set <a href="#author-request-headers">author request headers</a> to the empty list.
   <li><p>Unset the <a href="#send-flag"><code>send()</code> flag</a>.
   <li><p>Set <a href="#response-0">response</a> to a
   <a class="external" href="http://fetch.spec.whatwg.org/#concept-network-error" title="concept-network-error">network error</a>.
   <li><p>Set <a href="#arraybuffer-response-entity-body">arraybuffer response entity body</a> to null.
   <li><p>Set <a href="#blob-response-entity-body">blob response entity body</a> to null.
   <li><p>Set <a href="#document-response-entity-body">document response entity body</a> to null.
   <li><p>Set <a href="#json-response-entity-body">JSON response entity body</a> to null.
   <li><p>Set <a href="#text-response-entity-body">text response entity body</a> to null.
  </ul>

 <li>
  <p>If the state is not <a href="#dom-xmlhttprequest-opened" title="dom-XMLHttpRequest-OPENED">OPENED</a>, run these
  substeps:

  <ol>
   <li><p>Change the state to <a href="#dom-xmlhttprequest-opened" title="dom-XMLHttpRequest-OPENED">OPENED</a>.

   <li><p><a class="external" href="http://dom.spec.whatwg.org/#concept-event-fire" title="concept-event-fire">Fire an event</a> named <code title="event-xhr-readystatechange"><a href="#event-xhr-readystatechange">readystatechange</a></code>.
  </ol>
</ol>



<h4 id="the-setrequestheader()-method"><span class="secno">4.5.2 </span>The <code title="">setRequestHeader()</code> method</h4>

<dl class="domintro">
 <dt><code><var title="">client</var> . <a href="#dom-xmlhttprequest-setrequestheader" title="dom-XMLHttpRequest-setRequestHeader">setRequestHeader</a>(<var>name</var>, <var>value</var>)</code>

 <dd>
  <p>Appends an <a class="external" href="http://fetch.spec.whatwg.org/#concept-header" title="concept-header">header</a> to
  <a href="#author-request-headers">author request headers</a>, or if <var>name</var> is already a
  <a class="external" href="http://fetch.spec.whatwg.org/#concept-header" title="concept-header">header</a>'s
  <a class="external" href="http://fetch.spec.whatwg.org/#concept-header-name" title="concept-header-name">name</a> in
  <a href="#author-request-headers">author request headers</a>, appends <var>value</var> to that
  <a class="external" href="http://fetch.spec.whatwg.org/#concept-header" title="concept-header">header</a>'s
  <a class="external" href="http://fetch.spec.whatwg.org/#concept-header-value" title="concept-header-value">value</a>.

  <p>Throws an "<code class="external"><a href="http://dom.spec.whatwg.org/#invalidstateerror">InvalidStateError</a></code>"
  exception if the state is not
  <a href="#dom-xmlhttprequest-opened" title="dom-XMLHttpRequest-OPENED">OPENED</a> or if the
  <a href="#send-flag"><code>send()</code> flag</a> is set.

  <p>Throws a "<code class="external"><a href="http://dom.spec.whatwg.org/#syntaxerror">SyntaxError</a></code>" exception if
  <var>name</var> is not a valid HTTP header field name or if
  <var>value</var> is not a valid HTTP header field value.
 </dd>
</dl>

<p class="note">As indicated in the algorithm below certain headers cannot
be set and are left up to the user agent. In addition there are certain
other headers the user agent will take control of if they are not set by
the author as indicated at the end of the
<code title="dom-XMLHttpRequest-send"><a href="#dom-xmlhttprequest-send">send()</a></code> method section.

<p>The
<dfn id="dom-xmlhttprequest-setrequestheader" title="dom-XMLHttpRequest-setRequestHeader"><code>setRequestHeader(<var>name</var>, <var>value</var>)</code></dfn>
method must run these steps:

<ol>
 <li><p>If the state is not <a href="#dom-xmlhttprequest-opened" title="dom-XMLHttpRequest-OPENED">OPENED</a>,
 <a class="external" href="http://dom.spec.whatwg.org/#concept-throw" title="concept-throw">throw</a> an
 "<code class="external"><a href="http://dom.spec.whatwg.org/#invalidstateerror">InvalidStateError</a></code>" exception.

 <li><p>If the <a href="#send-flag"><code>send()</code> flag</a> is set,
 <a class="external" href="http://dom.spec.whatwg.org/#concept-throw" title="concept-throw">throw</a> an
 "<code class="external"><a href="http://dom.spec.whatwg.org/#invalidstateerror">InvalidStateError</a></code>" exception.

 <li><p>If <var>name</var> does not match the
 <a class="external" href="http://tools.ietf.org/html/rfc2616/#section-4.2">field-name</a> production,
 <a class="external" href="http://dom.spec.whatwg.org/#concept-throw" title="concept-throw">throw</a> a
 "<code class="external"><a href="http://dom.spec.whatwg.org/#syntaxerror">SyntaxError</a></code>" exception.

 <li>
  <p>If <var>value</var> does not match the
  <a class="external" href="http://tools.ietf.org/html/rfc2616/#section-4.2">field-value</a> production,
  <a class="external" href="http://dom.spec.whatwg.org/#concept-throw" title="concept-throw">throw</a> a
  "<code class="external"><a href="http://dom.spec.whatwg.org/#syntaxerror">SyntaxError</a></code>" exception.

  <p class="note">An empty string represents an empty header field value.

 <li><p>Terminate these steps if <var>name</var> is a
 <a class="external" href="http://fetch.spec.whatwg.org/#concept-forbidden-author-header-names" title="concept-forbidden-author-header-names">forbidden author header name</a>.

 <li><p>If <var>name</var> is not a
 <a class="external" href="http://fetch.spec.whatwg.org/#concept-header-name" title="concept-header-name">name</a> of a
 <a class="external" href="http://fetch.spec.whatwg.org/#concept-header" title="concept-header">header</a> in
 <a href="#author-request-headers">author request headers</a>, append a
 <a class="external" href="http://fetch.spec.whatwg.org/#concept-header" title="concept-header">header</a> whose
 <a class="external" href="http://fetch.spec.whatwg.org/#concept-header-name" title="concept-header-name">name</a> is
 <var>name</var> and
 <a class="external" href="http://fetch.spec.whatwg.org/#concept-header-value" title="concept-header-value">value</a> is
 <var>value</var> to <a href="#author-request-headers">author request headers</a>.

 <li>
  <p>Otherwise, append `<code>,</code>`, followed by 0x20, followed by
  <var>value</var>, to the
  <a class="external" href="http://fetch.spec.whatwg.org/#concept-header-value" title="concept-header-value">value</a> of the
  <a class="external" href="http://fetch.spec.whatwg.org/#concept-header" title="concept-header">header</a> in
  <a href="#author-request-headers">author request headers</a> whose
  <a class="external" href="http://fetch.spec.whatwg.org/#concept-header-name" title="concept-header-name">name</a> is
  <var>name</var>.

  <p class="note">The XMLHttpRequest standard intentionally constraints the
  use of HTTP here in line with contemporary implementations.
</ol>

<div class="example">
 <p>Some simple code demonstrating what happens when setting the same
 header twice:

 <pre><code>// The following script:
var client = new XMLHttpRequest();
client.open('GET', 'demo.cgi');
client.setRequestHeader('X-Test', 'one');
client.setRequestHeader('X-Test', 'two');
client.send();

// …results in the following header being sent:
X-Test: one, two</code></pre>
</div>


<h4 id="the-timeout-attribute"><span class="secno">4.5.3 </span>The <code title="">timeout</code> attribute</h4>

<dl class="domintro">
 <dt><code><var title="">client</var> . <a href="#dom-xmlhttprequest-timeout" title="dom-XMLHttpRequest-timeout">timeout</a></code>
 <dd>
  <p>Can be set to a time in milliseconds. When set to a non-zero value
  will cause <a class="external" href="http://fetch.spec.whatwg.org/#concept-fetch" title="concept-fetch">fetching</a> to
  terminate after the given time has passed. When the time has passed, the request has
  not yet completed, and the <a href="#synchronous-flag">synchronous flag</a> is unset, a
  <code title="event-xhr-timeout"><a href="#event-xhr-timeout">timeout</a></code> event will then be
  <a class="external" href="http://dom.spec.whatwg.org/#concept-event-dispatch" title="concept-event-dispatch">dispatched</a>,
  or a "<code class="external"><a href="http://dom.spec.whatwg.org/#timeouterror">TimeoutError</a></code>" exception will be
  <a class="external" href="http://dom.spec.whatwg.org/#concept-throw" title="concept-throw">thrown</a> otherwise
  (for the <code title="dom-XMLHttpRequest"><a href="#dom-xmlhttprequest">send()</a></code> method).
  <p>When set: throws an
  "<code class="external"><a href="http://dom.spec.whatwg.org/#invalidaccesserror">InvalidAccessError</a></code>" exception if
  the <a href="#synchronous-flag">synchronous flag</a> is set and the
  <a class="external" href="http://www.whatwg.org/specs/web-apps/current-work/multipage/infrastructure.html#javascript-global-environment">JavaScript global environment</a> is a
  <a class="external" href="http://www.whatwg.org/specs/web-apps/current-work/multipage/webappapis.html#document-environment">document environment</a>.
 </dd>
</dl>

<p>The
<dfn id="dom-xmlhttprequest-timeout" title="dom-XMLHttpRequest-timeout"><code>timeout</code></dfn>
attribute must return its value. Initially its value must be zero.

<p>Setting the <code title="dom-XMLHttpRequest-timeout"><a href="#dom-xmlhttprequest-timeout">timeout</a></code>
attribute must run these steps:

<ol>
 <li><p>If the
 <a class="external" href="http://www.whatwg.org/specs/web-apps/current-work/multipage/infrastructure.html#javascript-global-environment">JavaScript global environment</a> is a
 <a class="external" href="http://www.whatwg.org/specs/web-apps/current-work/multipage/webappapis.html#document-environment">document environment</a> and the
 <a href="#synchronous-flag">synchronous flag</a> is set,
 <a class="external" href="http://dom.spec.whatwg.org/#concept-throw" title="concept-throw">throw</a> an
 "<code class="external"><a href="http://dom.spec.whatwg.org/#invalidaccesserror">InvalidAccessError</a></code>" exception.

 <li><p>Set its value to the new value.
</ol>

<p class="note">This implies that the
<code title="dom-XMLHttpRequest-timeout"><a href="#dom-xmlhttprequest-timeout">timeout</a></code> attribute can be
set while <a class="external" href="http://fetch.spec.whatwg.org/#concept-fetch" title="concept-fetch">fetching</a> is in
progress. If that occurs it will still be measured relative to the start
of <a class="external" href="http://fetch.spec.whatwg.org/#concept-fetch" title="concept-fetch">fetching</a>.


<h4 id="the-withcredentials-attribute"><span class="secno">4.5.4 </span>The <code title="">withCredentials</code> attribute</h4>

<dl class="domintro">
 <dt><code><var title="">client</var> . <a href="#dom-xmlhttprequest-withcredentials" title="dom-XMLHttpRequest-withCredentials">withCredentials</a></code>
 <dd>
  <p>True when <a href="#user-credentials">user credentials</a> are to be included in a
  cross-origin request. False when they are to be excluded in a
  cross-origin request and when cookies are to be ignored in its response.
  Initially false.

  <p>When set: throws an
  "<code class="external"><a href="http://dom.spec.whatwg.org/#invalidstateerror">InvalidStateError</a></code>" exception if the
  state is not <a href="#dom-xmlhttprequest-unsent" title="dom-XMLHttpRequest-UNSENT">UNSENT</a> or
  <a href="#dom-xmlhttprequest-opened" title="dom-XMLHttpRequest-OPENED">OPENED</a>, or if
  the <a href="#send-flag"><code>send()</code> flag</a> is set.
  <p>When set: throws an
  "<code class="external"><a href="http://dom.spec.whatwg.org/#invalidaccesserror">InvalidAccessError</a></code>" exception if
  either the <a href="#synchronous-flag">synchronous flag</a> is set and the
  <a class="external" href="http://www.whatwg.org/specs/web-apps/current-work/multipage/infrastructure.html#javascript-global-environment">JavaScript global environment</a> is a
  <a class="external" href="http://www.whatwg.org/specs/web-apps/current-work/multipage/webappapis.html#document-environment">document environment</a>.
 </dd>
</dl>

<p>The
<dfn id="dom-xmlhttprequest-withcredentials" title="dom-XMLHttpRequest-withCredentials"><code>withCredentials</code></dfn>
attribute must return its value. Initially its value must be false.

<p>Setting the
<code title="dom-XMLHttpRequest-withCredentials"><a href="#dom-xmlhttprequest-withcredentials">withCredentials</a></code>
attribute must run these steps:

<ol>
 <li><p>If the state is not <a href="#dom-xmlhttprequest-unsent" title="dom-XMLHttpRequest-UNSENT">UNSENT</a> or
 <a href="#dom-xmlhttprequest-opened" title="dom-XMLHttpRequest-OPENED">OPENED</a>,
 <a class="external" href="http://dom.spec.whatwg.org/#concept-throw" title="concept-throw">throw</a> an
 "<code class="external"><a href="http://dom.spec.whatwg.org/#invalidstateerror">InvalidStateError</a></code>" exception.

 <li><p>If the <a href="#send-flag"><code>send()</code> flag</a> is set,
 <a class="external" href="http://dom.spec.whatwg.org/#concept-throw" title="concept-throw">throw</a> an
 "<code class="external"><a href="http://dom.spec.whatwg.org/#invalidstateerror">InvalidStateError</a></code>" exception.

 <li><p>If the
 <a class="external" href="http://www.whatwg.org/specs/web-apps/current-work/multipage/infrastructure.html#javascript-global-environment">JavaScript global environment</a> is a
 <a class="external" href="http://www.whatwg.org/specs/web-apps/current-work/multipage/webappapis.html#document-environment">document environment</a> and the
 <a href="#synchronous-flag">synchronous flag</a> is set,
 <a class="external" href="http://dom.spec.whatwg.org/#concept-throw" title="concept-throw">throw</a> an
 "<code class="external"><a href="http://dom.spec.whatwg.org/#invalidaccesserror">InvalidAccessError</a></code>" exception.

 <li><p>Set the <code title="dom-XMLHttpRequest-withCredentials"><a href="#dom-xmlhttprequest-withcredentials">withCredentials</a></code>
 attribute's value to the given value.
</ol>

<p class="note">The <code title="dom-XMLHttpRequest-withCredentials"><a href="#dom-xmlhttprequest-withcredentials">withCredentials</a></code>
attribute has no effect when
<a class="external" href="http://fetch.spec.whatwg.org/#concept-fetch" title="concept-fetch">fetching</a>
<a class="external" href="http://www.whatwg.org/specs/web-apps/current-work/multipage/origin-0.html#same-origin" title="same origin">same-origin</a> resources.


<h4 id="the-upload-attribute"><span class="secno">4.5.5 </span>The <code title="">upload</code> attribute</h4>

<dl class="domintro">
 <dt><code><var title="">client</var> . <a href="#dom-xmlhttprequest-upload" title="dom-XMLHttpRequest-upload">upload</a></code>
 <dd><p>Returns the associated <code><a href="#xmlhttprequestupload">XMLHttpRequestUpload</a></code>
 object. It can be used to gather transmission information when data is
 transferred to a server.
</dl>

<p>The
<dfn id="dom-xmlhttprequest-upload" title="dom-XMLHttpRequest-upload"><code>upload</code></dfn>
attribute must return the associated
<code><a href="#xmlhttprequestupload">XMLHttpRequestUpload</a></code> object.

<p class="note">As indicated earlier, each <code><a href="#xmlhttprequest">XMLHttpRequest</a></code>
object has an associated <code><a href="#xmlhttprequestupload">XMLHttpRequestUpload</a></code> object.


<h4 id="the-send()-method"><span class="secno">4.5.6 </span>The <code title="">send()</code> method</h4>

<dl class="domintro">
 <dt><code><var title="">client</var> . <a href="#dom-xmlhttprequest-send" title="dom-XMLHttpRequest-send">send</a>([<var title="">data</var> = null])</code>
 <dd>
  <p>Initiates the request. The optional argument provides the
  <a href="#request-entity-body">request entity body</a>. The argument is ignored if
  <a href="#request-method">request method</a> is <code>GET</code> or
  <code>HEAD</code>.

  <p>Throws an "<code class="external"><a href="http://dom.spec.whatwg.org/#invalidstateerror">InvalidStateError</a></code>"
  exception if the state is not
  <a href="#dom-xmlhttprequest-opened" title="dom-XMLHttpRequest-OPENED">OPENED</a> or if the
  <a href="#send-flag"><code>send()</code> flag</a> is set.
 </dd>
</dl>

<p>The <dfn id="dom-xmlhttprequest-send" title="dom-XMLHttpRequest-send"><code>send(<var>data</var>)</code></dfn>
method must run these steps:

<ol>
 <li><p>If the state is not <a href="#dom-xmlhttprequest-opened" title="dom-XMLHttpRequest-OPENED">OPENED</a>,
 <a class="external" href="http://dom.spec.whatwg.org/#concept-throw" title="concept-throw">throw</a> an
 "<code class="external"><a href="http://dom.spec.whatwg.org/#invalidstateerror">InvalidStateError</a></code>" exception.

 <li><p>If the <a href="#send-flag"><code>send()</code> flag</a> is set,
 <a class="external" href="http://dom.spec.whatwg.org/#concept-throw" title="concept-throw">throw</a> an
 "<code class="external"><a href="http://dom.spec.whatwg.org/#invalidstateerror">InvalidStateError</a></code>" exception.

 <li><p>If the <a href="#request-method">request method</a> is <code>GET</code> or
 <code>HEAD</code>, set <var title="">data</var> to null.

 <li>
  <p>If <var title="">data</var> is null, do not include a
  <a href="#request-entity-body">request entity body</a> and go to the next step.

  <p>Otherwise, let <var>encoding</var> be null, <var>mime type</var> be
  null, and then follow these rules, depending on <var title="">data</var>:

  <dl class="switch">
   <dt id="dom-XMLHttpRequest-send-ArrayBufferView"><code class="external"><a href="http://www.khronos.org/registry/typedarray/specs/latest/#6">ArrayBufferView</a></code>
   <dd><p>Let the <a href="#request-entity-body">request entity body</a> be the raw data
   represented by <var title="">data</var>.</dd>

   <dt id="dom-XMLHttpRequest-send-Blob"><code class="external"><a href="http://dev.w3.org/2006/webapi/FileAPI/#blob">Blob</a></code>
   <dd>
    <p>If the object's <code title="">type</code> attribute value is not
    the empty string, let <var>mime type</var> be its value.

    <p class="note">See also <code class="external"><a href="http://dev.w3.org/2006/webapi/FileAPI/#blob">Blob</a></code>'s
    <code class="external" title="dom-Blob-type"><a href="http://dev.w3.org/2006/webapi/FileAPI/#dfn-type">type</a></code> attribute.

    <p>Let the <a href="#request-entity-body">request entity body</a> be the raw data
    represented by <var>data</var>.
   </dd>

   <dt id="dom-XMLHttpRequest-send-document"><a class="external" href="http://dom.spec.whatwg.org/#concept-document" title="concept-document">document</a>
   <dd>
    <p>Let <var>encoding</var> be "<code title="">UTF-8</code>".

    <p>If <var>data</var> is an <a class="external" href="http://dom.spec.whatwg.org/#html-document">HTML document</a>, let
    <var>mime type</var> be "<code>text/html</code>", or let <var>mime type</var> be
    "<code>application/xml</code>" otherwise. Then append "<code>;charset=UTF-8</code>" to
    <var>mime type</var>.

    <p>Let the <a href="#request-entity-body">request entity body</a> be <var>data</var>,
    <a class="external" href="http://domparsing.spec.whatwg.org/#concept-serialize" title="concept-serialize">serialized</a>,
    <a class="external" href="http://dev.w3.org/2006/webapi/WebIDL/#dfn-obtain-unicode" title="convert a DOMString to a sequence of Unicode characters">converted to Unicode</a>,
    and <a class="external" href="http://encoding.spec.whatwg.org/#utf-8-encode" title="utf-8 encode">utf-8 encoded</a>.
    Re-throw any exception
    <a class="external" href="http://domparsing.spec.whatwg.org/#concept-serialize" title="concept-serialize">serializing</a> throws.

    <p class="note">If <var>data</var> cannot be
    <a class="external" href="http://domparsing.spec.whatwg.org/#concept-serialize" title="concept-serialize">serialized</a>, an
    "<code class="external"><a href="http://dom.spec.whatwg.org/#invalidstateerror">InvalidStateError</a></code>" exception is thrown.

   <dt id="dom-XMLHttpRequest-send-a-string">a string
   <dd>
    <p>Let <var>encoding</var> be "<code title="">UTF-8</code>".

    <p>Let <var>mime type</var> be "<code>text/plain;charset=UTF-8</code>".

    <p>Let the <a href="#request-entity-body">request entity body</a> be <var title="">data</var>,
    <a class="external" href="http://encoding.spec.whatwg.org/#utf-8-encode" title="utf-8 encode">utf-8 encoded</a>.

   <dt id="dom-XMLHttpRequest-send-FormData"><code><a href="#formdata">FormData</a></code>
   <dd>
    <p>Let the <a href="#request-entity-body">request entity body</a> be the result of running
    the
    <a class="external" href="http://www.whatwg.org/specs/web-apps/current-work/multipage/association-of-controls-and-forms.html#multipart/form-data-encoding-algorithm"><code>multipart/form-data</code> encoding algorithm</a>
    with <var>data</var> as <var>form data set</var> and with
    <a class="external" href="http://encoding.spec.whatwg.org/#utf-8">utf-8</a> as the
    explicit character encoding.
    <!-- need to provide explicit character encoding because otherwise the
         encoding of the document is used -->

    <p>Let <var>mime type</var> be the concatenation of
    "<code title="">multipart/form-data;</code>",
    a U+0020 SPACE character,
    "<code title="">boundary=</code>", and the
    <a class="external" href="http://www.whatwg.org/specs/web-apps/current-work/multipage/association-of-controls-and-forms.html#multipart/form-data-boundary-string"><code>multipart/form-data</code> boundary string</a>
    generated by the
    <a class="external" href="http://www.whatwg.org/specs/web-apps/current-work/multipage/association-of-controls-and-forms.html#multipart/form-data-encoding-algorithm"><code>multipart/form-data</code> encoding algorithm</a>.

   <dt id="dom-XMLHttpRequest-send-URLSearchParams"><code class="external"><a href="http://url.spec.whatwg.org/#urlsearchparams">URLSearchParams</a></code>
   <dd>
    <p>Let the <a href="#request-entity-body">request entity body</a> be the result of running the
    <a class="external" href="http://url.spec.whatwg.org/#concept-urlencoded-serializer" title="concept-urlencoded-serializer"><code>application/x-www-form-urlencoded</code> serializer</a>
    with <var>data</var>'s associated list of name-value pairs as <var>pairs</var>.
    <!-- utf-8 implied -->

    <p>Let <var>mime type</var> be
    "<code title="">application/x-www-form-urlencoded;charset=UTF-8</code>.
  </dl>

  <p>If a <code>Content-Type</code> header is in
  <a href="#author-request-headers">author request headers</a> and its value is a
  <a class="external" href="http://www.whatwg.org/specs/web-apps/current-work/multipage/infrastructure.html#valid-mime-type">valid MIME type</a> that has a
  <code>charset</code> parameter whose value is not a case-insensitive
  match for <var title="">encoding</var>, and <var title="">encoding</var>
  is not null, set all the <code>charset</code> parameters of that
  <code>Content-Type</code> header to <var title="">encoding</var>.

  <p>If no <code>Content-Type</code> header is in
  <a href="#author-request-headers">author request headers</a> and <var title="">mime type</var> is
  not null, append a <code>Content-Type</code> header with value
  <var title="">mime type</var> to <a href="#author-request-headers">author request headers</a>.

  <!-- reminder: if we ever change this to always include charset it has
  to be included as the first parameter for compatibility reasons -->


 <li><p>If the <a href="#synchronous-flag">synchronous flag</a> is set, release the
 <a class="external" href="http://www.whatwg.org/specs/web-apps/current-work/multipage/webappapis.html#storage-mutex">storage mutex</a>.

 <li><p>Unset the <a href="#upload-complete-flag">upload complete flag</a> and <a href="#upload-events-flag">upload events flag</a>.

 <li><p>If there is no <a href="#request-entity-body">request entity body</a> or if it is empty,
 set the <a href="#upload-complete-flag">upload complete flag</a>.

 <li><p>If the <a href="#synchronous-flag">synchronous flag</a> is unset and one or more
 event listeners are registered on the <code><a href="#xmlhttprequestupload">XMLHttpRequestUpload</a></code>
 object, set the <a href="#upload-events-flag">upload events flag</a>.

 <li>
  <p>If the <a href="#synchronous-flag">synchronous flag</a> is unset, run these substeps:

  <ol>
   <li><p>Set the <a href="#send-flag"><code>send()</code> flag</a>.

   <li><p><a href="#concept-event-fire-progress" title="concept-event-fire-progress">Fire a progress event</a> named <code title="event-xhr-loadstart"><a href="#event-xhr-loadstart">loadstart</a></code>.

   <li><p>If the <a href="#upload-complete-flag">upload complete flag</a> is unset,
   <a href="#concept-event-fire-upload-progress" title="concept-event-fire-upload-progress">fire an upload progress event</a> named <code title="event-xhr-loadstart"><a href="#event-xhr-loadstart">loadstart</a></code>
   on the <code><a href="#xmlhttprequestupload">XMLHttpRequestUpload</a></code> object.

   <li><p>Return the <code title="dom-XMLHttpRequest-send"><a href="#dom-xmlhttprequest-send">send()</a></code>
   method call, but continue running the steps in this algorithm.
  </ol>


 <li>
  <p>Let <var title="">req</var> be a new
  <a class="external" href="http://fetch.spec.whatwg.org/#concept-request" title="concept-request">request</a>, initialized as
  follows:

  <dl>
   <dt><a class="external" href="http://fetch.spec.whatwg.org/#concept-request-method" title="concept-request-method">method</a>
   <dd><a href="#request-method">request method</a>
   <dt><a class="external" href="http://fetch.spec.whatwg.org/#concept-request-url" title="concept-request-url">url</a>
   <dd><a href="#request-url">request URL</a>
   <dt><a class="external" href="http://fetch.spec.whatwg.org/#concept-request-author-headers" title="concept-request-author-headers">author headers</a>
   <dd><a href="#author-request-headers">author request headers</a>
   <dt><a class="external" href="http://fetch.spec.whatwg.org/#concept-request-origin" title="concept-request-origin">origin</a>
   <dd><a href="#source-origin">source origin</a>
   <dt><a class="external" href="http://fetch.spec.whatwg.org/#force-origin-header-flag">force <code title="">Origin</code> header flag</a>
   <dd>Set.
   <dt><a class="external" href="http://fetch.spec.whatwg.org/#concept-request-referrer" title="concept-request-referrer">referrer</a>
   <dd><a class="XXX" href="#referrer-source">referrer source</a>
   <dt><a class="external" href="http://fetch.spec.whatwg.org/#concept-request-body" title="concept-request-body">body</a>
   <dd><a href="#request-entity-body">request entity body</a>
   <dt><a data-anolis-spec="fetch" href="#synchronous-flag">synchronous flag</a>
   <dd>Set if the <a href="#synchronous-flag">synchronous flag</a> is set.
   <dt><a class="external" href="http://fetch.spec.whatwg.org/#concept-request-mode" title="concept-request-mode">mode</a>
   <dd><i title="">CORS</i>
   <dt><a class="external" href="http://fetch.spec.whatwg.org/#force-preflight-flag">force preflight flag</a>
   <dd>Set if the <a href="#upload-events-flag">upload events flag</a> is set.
   <dt><a class="external" href="http://fetch.spec.whatwg.org/#concept-request-omit-credentials-mode" title="concept-request-omit-credentials-mode">omit credentials mode</a>
   <dd>If the <code title="dom-XMLHttpRequest-withCredentials"><a href="#dom-xmlhttprequest-withcredentials">withCredentials</a></code>
   attribute value is true, <i title="">never</i>, and <i title="">CORS</i> otherwise.
   <dt><a class="external" href="http://fetch.spec.whatwg.org/#concept-request-use-url-credentials-flag" title="concept-request-use-url-credentials-flag">use URL credentials flag</a>
   <dd>Set if either <a href="#request-url">request URL</a>'s
   <a class="external" href="http://url.spec.whatwg.org/#concept-url-username" title="concept-url-username">username</a>
   is not the empty string or <a href="#request-url">request URL</a>'s
   <a class="external" href="http://url.spec.whatwg.org/#concept-url-password" title="concept-url-password">password</a> is non-null.
  </dl>

 <li><p>If a <a class="external" href="http://fetch.spec.whatwg.org/#concept-header" title="concept-header">header</a>
 <a class="external" href="http://fetch.spec.whatwg.org/#concept-header-name" title="concept-header-name">named</a>
 `<code>Accept-Language</code>` is not in <var title="">req</var>'s
 <a class="external" href="http://fetch.spec.whatwg.org/#concept-request-author-headers" title="concept-request-author-headers">author headers</a>,
 append one with an appropriate
 <a class="external" href="http://fetch.spec.whatwg.org/#concept-header-value" title="concept-header-value">value</a>.

 <li><p>If a <a class="external" href="http://fetch.spec.whatwg.org/#concept-header" title="concept-header">header</a>
 <a class="external" href="http://fetch.spec.whatwg.org/#concept-header-name" title="concept-header-name">named</a>
 `<code>Accept</code>` is not in <var title="">req</var>'s
 <a class="external" href="http://fetch.spec.whatwg.org/#concept-request-author-headers" title="concept-request-author-headers">author headers</a>,
 append one with `<code title="">*/*</code>` as
 <a class="external" href="http://fetch.spec.whatwg.org/#concept-header-value" title="concept-header-value">value</a>.

 <li>
  <p><a class="external" href="http://fetch.spec.whatwg.org/#concept-fetch" title="concept-fetch">Fetch</a> <var title="">req</var>.

  <p>If <var title="">req</var>'s <a data-anolis-spec="fetch" href="#synchronous-flag">synchronous flag</a> is
  set, pass the return value, synchronously, to
  <a class="external" href="http://fetch.spec.whatwg.org/#process-response-end-of-file">process response end-of-file</a> below. Otherwise,
  handle the <a class="external" href="http://www.whatwg.org/specs/web-apps/current-work/multipage/webappapis.html#concept-task" title="concept-task">tasks</a>
  <a class="external" href="http://www.whatwg.org/specs/web-apps/current-work/multipage/webappapis.html#queue-a-task" title="queue a task">queued</a> on the
  <a class="external" href="http://www.whatwg.org/specs/web-apps/current-work/multipage/webappapis.html#networking-task-source">networking task source</a> per below.

  <p>If the <code title="dom-XMLHttpRequest-timeout"><a href="#dom-xmlhttprequest-timeout">timeout</a></code> attribute value is not
  0, <a class="external" href="http://fetch.spec.whatwg.org/#concept-fetch-terminate" title="concept-fetch-terminate">terminate</a>
  <a class="external" href="http://fetch.spec.whatwg.org/#concept-fetch" title="concept-fetch">fetching</a> after the amount of
  milliseconds specified by the <code title="dom-XMLHttpRequest-timeout"><a href="#dom-xmlhttprequest-timeout">timeout</a></code>
  attribute value have passed with reason <i title="">timeout</i>.

  <p>To <a class="external" href="http://fetch.spec.whatwg.org/#process-request-body">process request body</a> for
  <var title="">request</var>,
  <a href="#concept-event-fire-upload-progress" title="concept-event-fire-upload-progress">fire an upload progress event</a> named
  <code title="event-xhr-progress"><a href="#event-xhr-progress">progress</a></code> on the
  <code><a href="#xmlhttprequestupload">XMLHttpRequestUpload</a></code> object.
  <!-- upload complete flag can never be set here I hope -->

  <p>To <a class="external" href="http://fetch.spec.whatwg.org/#process-request-end-of-file">process request end-of-file</a> for
  <var title="">request</var>, run these substeps:

  <ol>
   <li><p>Set the <a href="#upload-complete-flag">upload complete flag</a>.

   <li><p><a href="#concept-event-fire-upload-progress" title="concept-event-fire-upload-progress">Fire an upload progress event</a> named <code title="event-xhr-progress"><a href="#event-xhr-progress">progress</a></code>
   on the <code><a href="#xmlhttprequestupload">XMLHttpRequestUpload</a></code> object.

   <li><p><a href="#concept-event-fire-upload-progress" title="concept-event-fire-upload-progress">Fire an upload progress event</a> named <code title="event-xhr-load"><a href="#event-xhr-load">load</a></code>
   on the <code><a href="#xmlhttprequestupload">XMLHttpRequestUpload</a></code> object.

   <li><p><a href="#concept-event-fire-upload-progress" title="concept-event-fire-upload-progress">Fire an upload progress event</a> named <code title="event-xhr-loadend"><a href="#event-xhr-loadend">loadend</a></code>
   on the <code><a href="#xmlhttprequestupload">XMLHttpRequestUpload</a></code> object.
  </ol>
  <!-- upload complete flag can never be set here I hope -->

  <p>To <a class="external" href="http://fetch.spec.whatwg.org/#process-response">process response</a> for <var title="">response</var>,
  run these substeps:

  <ol>
   <li><p><a href="#handle-errors">Handle errors</a> for <var title="">response</var>.

   <li><p>Set <a href="#response-0">response</a> to <var title="">response</var>.

   <li>
    <p>If state is <a href="#dom-xmlhttprequest-opened" title="dom-XMLHttpRequest-OPENED">OPENED</a>, run these
    subsubsteps:

    <ol>
     <li><p>Change the state to <a href="#dom-xmlhttprequest-headers_received" title="dom-XMLHttpRequest-HEADERS_RECEIVED">HEADERS_RECEIVED</a>.

     <li><p><a class="external" href="http://dom.spec.whatwg.org/#concept-event-fire" title="concept-event-fire">Fire an event</a> named <code title="event-xhr-readystatechange"><a href="#event-xhr-readystatechange">readystatechange</a></code>.
    </ol>
  </ol>

  <p>To <a class="external" href="http://fetch.spec.whatwg.org/#process-response-body">process response body</a> for
  <var title="">response</var>, run these substeps:

  <ol>
   <li><p><a href="#handle-errors">Handle errors</a> for <var title="">response</var>.

   <li>
    <p>If state is
    <a href="#dom-xmlhttprequest-headers_received" title="dom-XMLHttpRequest-HEADERS_RECEIVED">HEADERS_RECEIVED</a>, run these
    subsubsteps:

    <ol>
     <li><p>Change the state to <a href="#dom-xmlhttprequest-loading" title="dom-XMLHttpRequest-LOADING">LOADING</a>.

     <li><p><a class="external" href="http://dom.spec.whatwg.org/#concept-event-fire" title="concept-event-fire">Fire an event</a> named <code title="event-xhr-readystatechange"><a href="#event-xhr-readystatechange">readystatechange</a></code>.
    </ol>

   <li><p>Update <a href="#response-entity-body">response entity body</a> with <var title="">response</var>'s
   <a class="external" href="http://fetch.spec.whatwg.org/#concept-response-body" title="concept-response-body">body</a>.

   <li><p><a href="#concept-event-fire-progress" title="concept-event-fire-progress">Fire a progress event</a> named <code title="event-xhr-progress"><a href="#event-xhr-progress">progress</a></code>.
  </ol>

  <p>To <a class="external" href="http://fetch.spec.whatwg.org/#process-response-end-of-file">process response end-of-file</a> for
  <var title="">response</var>, run these substeps:

  <ol>
   <li><p><a href="#handle-errors">Handle errors</a> for <var title="">response</var>.

   <li><p>If the <a href="#synchronous-flag">synchronous flag</a> is set, set <a href="#response-0">response</a> to
   <var title="">response</var>.

   <li>
    <p>If state is <a href="#dom-xmlhttprequest-loading" title="dom-XMLHttpRequest-LOADING">LOADING</a>, run these
    subsubsteps:

    <ol>
     <li><p>Update <a href="#response-entity-body">response entity body</a> with <var title="">response</var>'s
     <a class="external" href="http://fetch.spec.whatwg.org/#concept-response-body" title="concept-response-body">body</a>.

     <li><p>Change the state to <a href="#dom-xmlhttprequest-done" title="dom-XMLHttpRequest-DONE">DONE</a>.

     <li><p>Unset the <a href="#send-flag"><code>send()</code> flag</a>.

     <li><p><a class="external" href="http://dom.spec.whatwg.org/#concept-event-fire" title="concept-event-fire">Fire an event</a> named <code title="event-xhr-readystatechange"><a href="#event-xhr-readystatechange">readystatechange</a></code>.

     <li><p><a href="#concept-event-fire-progress" title="concept-event-fire-progress">Fire a progress event</a> named <code title="event-xhr-progress"><a href="#event-xhr-progress">progress</a></code>.

     <li><p><a href="#concept-event-fire-progress" title="concept-event-fire-progress">Fire a progress event</a> named <code title="event-xhr-load"><a href="#event-xhr-load">load</a></code>.

     <li><p><a href="#concept-event-fire-progress" title="concept-event-fire-progress">Fire a progress event</a> named <code title="event-xhr-loadend"><a href="#event-xhr-loadend">loadend</a></code>.
    </ol>
  </ol>
</ol>

<p>To <dfn id="handle-errors">handle errors</dfn> for <var title="">response</var> run these substeps:

<ol>
 <li><p>If <var title="">response</var> is a
 <a class="external" href="http://fetch.spec.whatwg.org/#concept-network-error" title="concept-network-error">network error</a>, run the
 <a href="#request-error-steps">request error steps</a> for event <code title="event-xhr-error"><a href="#event-xhr-error">error</a></code> and
 exception "<code class="external"><a href="http://dom.spec.whatwg.org/#networkerror">NetworkError</a></code>".

 <li>
  <p>Otherwise, if <var title="">response</var> has a
  <a class="external" href="http://fetch.spec.whatwg.org/#concept-response-termination-reason" title="concept-response-termination-reason">termination reason</a>:

  <dl class="switch">
   <dt><i title="">end-user abort</i>
   <dd><p>Run the <a href="#request-error-steps">request error steps</a> for event
   <code title="event-xhr-abort"><a href="#event-xhr-abort">abort</a></code> and exception
   "<code class="external"><a href="http://dom.spec.whatwg.org/#aborterror">AbortError</a></code>".

   <dt><i title="">fatal</i>
   <dd>
    <p>Terminate the entire <code title="dom-XMLHTtpRequest-send"><a href="#dom-xmlhttprequest-send">send()</a></code> algorithm.
    <p>Game over.

   <dt><i title="">timeout</i>
   <dd><p>Run the <a href="#request-error-steps">request error steps</a> for event
   <code title="event-xhr-timeout"><a href="#event-xhr-timeout">timeout</a></code> and exception
   "<code class="external"><a href="http://dom.spec.whatwg.org/#timeouterror">TimeoutError</a></code>".
  </dl>
</ol>

<p>The <dfn id="request-error-steps">request error steps</dfn> for event <var title="">event</var> and optionally an
exception <var>exception</var> are:

<ol>
 <li><p>Change the state to <a href="#dom-xmlhttprequest-done" title="dom-XMLHttpRequest-DONE">DONE</a>.

 <li><p>Unset the <a href="#send-flag"><code>send()</code> flag</a>.

 <li><p>Set <a href="#response-0">response</a> to a
 <a class="external" href="http://fetch.spec.whatwg.org/#concept-network-error" title="concept-network-error">network error</a>.

 <li><p>If the <a href="#synchronous-flag">synchronous flag</a> is set,
 <a class="external" href="http://dom.spec.whatwg.org/#concept-throw" title="concept-throw">throw</a> an <var>exception</var>
 exception.

 <li>
  <p><a class="external" href="http://dom.spec.whatwg.org/#concept-event-fire" title="concept-event-fire">Fire an event</a> named <code title="event-xhr-readystatechange"><a href="#event-xhr-readystatechange">readystatechange</a></code>.

  <p class="note">At this point it is clear that the <a href="#synchronous-flag">synchronous flag</a> is unset.

 <li>
  <p>If the <a href="#upload-complete-flag">upload complete flag</a> is unset, follow these substeps:

  <ol>
   <li><p>Set the <a href="#upload-complete-flag">upload complete flag</a>.

   <li><p><a href="#concept-event-fire-upload-progress" title="concept-event-fire-upload-progress">Fire an upload progress event</a> named
   <code title="event-xhr-progress"><a href="#event-xhr-progress">progress</a></code> on the <code><a href="#xmlhttprequestupload">XMLHttpRequestUpload</a></code> object.

   <li><p><a href="#concept-event-fire-upload-progress" title="concept-event-fire-upload-progress">Fire an upload progress event</a> named
   <var title="">event</var> on the <code><a href="#xmlhttprequestupload">XMLHttpRequestUpload</a></code> object.

   <li><p><a href="#concept-event-fire-upload-progress" title="concept-event-fire-upload-progress">Fire an upload progress event</a> named
   <code title="event-xhr-loadend"><a href="#event-xhr-loadend">loadend</a></code> on the <code><a href="#xmlhttprequestupload">XMLHttpRequestUpload</a></code> object.
  </ol>

 <li><p><a href="#concept-event-fire-progress" title="concept-event-fire-progress">Fire a progress event</a> named <code title="event-xhr-progress"><a href="#event-xhr-progress">progress</a></code>.

 <li><p><a href="#concept-event-fire-progress" title="concept-event-fire-progress">Fire a progress event</a> named <var title="">event</var>.

 <li><p><a href="#concept-event-fire-progress" title="concept-event-fire-progress">Fire a progress event</a> named <code title="event-xhr-loadend"><a href="#event-xhr-loadend">loadend</a></code>.
</ol>


<h4 id="the-abort()-method"><span class="secno">4.5.7 </span>The <code title="">abort()</code> method</h4>

  <dl class="domintro">
   <dt><code><var title="">client</var> . <a href="#dom-xmlhttprequest-abort" title="dom-XMLHttpRequest-abort">abort</a>()</code>
   <dd>Cancels any network activity.
  </dl>

<p>The <dfn id="dom-xmlhttprequest-abort" title="dom-XMLHttpRequest-abort"><code>abort()</code></dfn> method must run
these steps:

<ol>
 <li><p><a href="#terminate-the-request">Terminate the request</a>.

 <li><p>If the state is <a href="#dom-xmlhttprequest-opened" title="dom-XMLHttpRequest-OPENED">OPENED</a> with the
 <a href="#send-flag"><code>send()</code> flag</a> set,
 <a href="#dom-xmlhttprequest-headers_received" title="dom-XMLHttpRequest-HEADERS_RECEIVED">HEADERS_RECEIVED</a>, or
 <a href="#dom-xmlhttprequest-loading" title="dom-XMLHttpRequest-LOADING">LOADING</a>, run the
 <a href="#request-error-steps">request error steps</a> for event <code title="event-xhr-abort"><a href="#event-xhr-abort">abort</a></code>.

 <li>
  <p>Change the state to <a href="#dom-xmlhttprequest-unsent" title="dom-XMLHttpRequest-UNSENT">UNSENT</a>.

  <p class="note">No <code title="event-xhr-readystatechange"><a href="#event-xhr-readystatechange">readystatechange</a></code> event
  is dispatched.
</ol>



<h3 id="response"><span class="secno">4.6 </span>Response</h3>

<p>An <code><a href="#xmlhttprequest">XMLHttpRequest</a></code> has an associated <dfn id="response-0">response</dfn>. Unless stated
otherwise it is a
<a class="external" href="http://fetch.spec.whatwg.org/#concept-network-error" title="concept-network-error">network error</a>.


<h4 id="the-status-attribute"><span class="secno">4.6.1 </span>The <code title="">status</code> attribute</h4>

<p>The
<dfn id="dom-xmlhttprequest-status" title="dom-XMLHttpRequest-status"><code>status</code></dfn>
attribute must return the <a href="#response-0">response</a>'s
<a class="external" href="http://fetch.spec.whatwg.org/#concept-response-status" title="concept-response-status">status</a>.


<h4 id="the-statustext-attribute"><span class="secno">4.6.2 </span>The <code title="">statusText</code> attribute</h4>

<p>The
<dfn id="dom-xmlhttprequest-statustext" title="dom-XMLHttpRequest-statusText"><code>statusText</code></dfn>
attribute must return the <a href="#response-0">response</a>'s
<a class="external" href="http://fetch.spec.whatwg.org/#concept-response-status-message" title="concept-response-status-message">status message</a>.


<h4 id="the-getresponseheader()-method"><span class="secno">4.6.3 </span>The <code title="">getResponseHeader()</code> method</h4>

<p>The
<dfn id="dom-xmlhttprequest-getresponseheader" title="dom-XMLHttpRequest-getResponseHeader"><code>getResponseHeader(<var>name</var>)</code></dfn>
method must run these steps:

<ol>
 <li><p>If <a href="#response-0">response</a>'s
 <a class="external" href="http://fetch.spec.whatwg.org/#concept-response-headers" title="concept-response-headers">headers</a> has multiple
 <a class="external" href="http://fetch.spec.whatwg.org/#concept-header" title="concept-header">headers</a> whose
 <a class="external" href="http://fetch.spec.whatwg.org/#concept-header-name" title="concept-header-name">name</a> is <var>name</var>,
 return their <a class="external" href="http://fetch.spec.whatwg.org/#concept-header-value" title="concept-header-value">values</a> in
 list order as a single byte sequence separated from each other by a 0x2C 0x20 byte pair.

 <li><p>If <a href="#response-0">response</a>'s
 <a class="external" href="http://fetch.spec.whatwg.org/#concept-response-headers" title="concept-response-headers">headers</a> has one
 <a class="external" href="http://fetch.spec.whatwg.org/#concept-header" title="concept-header">header</a> whose
 <a class="external" href="http://fetch.spec.whatwg.org/#concept-header-name" title="concept-header-name">name</a> is <var>name</var>,
 return its <a class="external" href="http://fetch.spec.whatwg.org/#concept-header-value" title="concept-header-value">value</a>.

 <li><p>Return null.
</ol>

<p class="note">The Fetch Standard filters
<a class="external" href="http://fetch.spec.whatwg.org/#concept-response-headers" title="concept-response-headers">headers</a> exposed by
<code title="dom-XMLHttpRequest-getResponseHeader"><a href="#dom-xmlhttprequest-getresponseheader">getResponseHeader()</a></code>.
<a href="#refsFETCH">[FETCH]</a>

<div class="example">

 <p>For the following script:

 <pre><code>var client = new XMLHttpRequest();
client.open("GET", "unicorns-are-teh-awesome.txt", true);
client.send();
client.onreadystatechange = function() {
  if(this.readyState == 2) {
    print(client.getResponseHeader("Content-Type"));
  }
}</code></pre>

 <p>The <code>print()</code> function will get to process something
 like:

 <pre><code>text/plain; charset=UTF-8</code></pre>
</div>


<h4 id="the-getallresponseheaders()-method"><span class="secno">4.6.4 </span>The <code title="">getAllResponseHeaders()</code> method</h4>

<p>The
<dfn id="dom-xmlhttprequest-getallresponseheaders" title="dom-XMLHttpRequest-getAllResponseHeaders"><code>getAllResponseHeaders()</code></dfn>
method must return all <a href="#response-0">response</a>'s
<a class="external" href="http://fetch.spec.whatwg.org/#concept-response-headers" title="concept-response-headers">headers</a>, in list order,
as a single byte sequence with each
<a class="external" href="http://fetch.spec.whatwg.org/#concept-header" title="concept-header">header</a> separated by a 0x0D 0x0A
byte pair, and each <a class="external" href="http://fetch.spec.whatwg.org/#concept-header-name" title="concept-header-name">name</a> and
<a class="external" href="http://fetch.spec.whatwg.org/#concept-header-value" title="concept-header-value">value</a> of a
<a class="external" href="http://fetch.spec.whatwg.org/#concept-header" title="concept-header">header</a> separated by a 0x3A 0x20
byte pair.

<p class="note">The Fetch Standard filters
<a class="external" href="http://fetch.spec.whatwg.org/#concept-response-headers" title="concept-response-headers">headers</a> exposed by
<code title="dom-XMLHttpRequest-getAllResponseHeaders"><a href="#dom-xmlhttprequest-getallresponseheaders">getAllResponseHeaders()</a></code>.
<a href="#refsFETCH">[FETCH]</a>

<div class="example">
 <p>For the following script:

 <pre><code>var client = new XMLHttpRequest();
client.open("GET", "narwhals-too.txt", true);
client.send();
client.onreadystatechange = function() {
  if(this.readyState == 2) {
    print(this.getAllResponseHeaders());
  }
}</code></pre>

 <p>The <code>print()</code> function will get to process something
 like:

 <pre><code>Date: Sun, 24 Oct 2004 04:58:38 GMT
Server: Apache/1.3.31 (Unix)
Keep-Alive: timeout=15, max=99
Connection: Keep-Alive
Transfer-Encoding: chunked
Content-Type: text/plain; charset=utf-8</code></pre>
</div>


<h4 id="response-entity-body-0"><span class="secno">4.6.5 </span>Response entity body</h4>

<p>The <dfn id="response-mime-type">response MIME type</dfn> is the
MIME type the `<code title="">Content-Type</code>` header contains excluding any
parameters and
<a class="external" href="http://dom.spec.whatwg.org/#converted-to-ascii-lowercase">converted to ASCII lowercase</a>, or null if
the response header can not be parsed or was omitted. The
<dfn id="override-mime-type">override MIME type</dfn> is initially null
and can get a value if
<code title="dom-XMLHttpRequest-overrideMimeType"><a href="#dom-xmlhttprequest-overridemimetype">overrideMimeType()</a></code>
is invoked. <dfn id="final-mime-type">Final MIME type</dfn> is the
<a href="#override-mime-type">override MIME type</a> unless that is null in which case it is
the <a href="#response-mime-type">response MIME type</a>.

<p>The <dfn id="response-charset">response charset</dfn> is the value of
the <code>charset</code> parameter of the `<code title="">Content-Type</code>` header
or null if there was no `<code title="">charset</code>` parameter or the header could
not be parsed or was omitted. The
<dfn id="override-charset">override charset</dfn> is initially null and
can get a value if <code title="dom-XMLHttpRequest-overrideMimeType"><a href="#dom-xmlhttprequest-overridemimetype">overrideMimeType()</a></code> is invoked.
<dfn id="final-charset">Final charset</dfn> is the
<a href="#override-charset">override charset</a> unless
that is null in which case it is the <a href="#response-charset">response charset</a>.



<hr>

<p>The <dfn id="response-entity-body">response entity body</dfn> is the
fragment of <a href="#response-0">response</a>'s
<a class="external" href="http://fetch.spec.whatwg.org/#concept-response-body" title="concept-response-body">body</a> received so far
(<a href="#dom-xmlhttprequest-loading" title="dom-XMLHttpRequest-LOADING">LOADING</a>) or the complete
<a class="external" href="http://fetch.spec.whatwg.org/#concept-response-body" title="concept-response-body">body</a> of the
<a href="#response-0">response</a> (<a href="#dom-xmlhttprequest-done" title="dom-XMLHttpRequest-DONE">DONE</a>). If
<a href="#response-0">response</a>'s
<a class="external" href="http://fetch.spec.whatwg.org/#concept-response-body" title="concept-response-body">body</a> is null,
<a href="#response-entity-body">response entity body</a> is null.

<hr>

<p>The
<dfn id="arraybuffer-response-entity-body">arraybuffer response entity body</dfn>
is either an <code class="external"><a href="http://www.khronos.org/registry/typedarray/specs/latest/#5">ArrayBuffer</a></code> representing
the <a href="#response-entity-body">response entity body</a> or null. If the
<a href="#arraybuffer-response-entity-body">arraybuffer response entity body</a> is null, let it be the return value of the
following algorithm:

<ol>
 <li><p>If the <a href="#response-entity-body">response entity body</a> is null, return an empty
 <code class="external"><a href="http://www.khronos.org/registry/typedarray/specs/latest/#5">ArrayBuffer</a></code> object.

 <li><p>Return an <code class="external"><a href="http://www.khronos.org/registry/typedarray/specs/latest/#5">ArrayBuffer</a></code>
 object representing the <a href="#response-entity-body">response entity body</a>.
</ol>


<p>The
<dfn id="blob-response-entity-body">blob response entity body</dfn> is either a
<code class="external"><a href="http://dev.w3.org/2006/webapi/FileAPI/#blob">Blob</a></code> representing the
<a href="#response-entity-body">response entity body</a> or null. If the <a href="#blob-response-entity-body">blob response entity body</a>
is null, let it be the return value of the following algorithm:

<ol>
 <li><p>If the <a href="#response-entity-body">response entity body</a> is null, return an empty
 <code class="external"><a href="http://dev.w3.org/2006/webapi/FileAPI/#blob">Blob</a></code> object.

 <li><p>Return a <code class="external"><a href="http://dev.w3.org/2006/webapi/FileAPI/#blob">Blob</a></code> object
 representing the <a href="#response-entity-body">response entity body</a>.
</ol>



<p>The
<dfn id="document-response-entity-body">document response entity body</dfn>
is either a <a class="external" href="http://dom.spec.whatwg.org/#concept-document" title="concept-document">document</a>
representing the <a href="#response-entity-body">response entity body</a> or null. If the
<a href="#document-response-entity-body">document response entity body</a> is null, let it be the return value of the
following algorithm:

<ol>
 <li><p>If the <a href="#response-entity-body">response entity body</a> is null, return null.

 <li><p>If the
 <a class="external" href="http://www.whatwg.org/specs/web-apps/current-work/multipage/infrastructure.html#javascript-global-environment">JavaScript global environment</a> is a
 <a class="external" href="http://www.whatwg.org/specs/web-apps/current-work/multipage/webappapis.html#worker-environment">worker environment</a>, return null.

 <li><p>If <a href="#final-mime-type">final MIME type</a> is not null,
 <code>text/html</code>, <code>text/xml</code>,
 <code>application/xml</code>, or does not end in
 <code title="">+xml</code>, return null.

 <li>
  <p>If <code title="dom-XMLHttpRequest-responseType"><a href="#dom-xmlhttprequest-responsetype">responseType</a></code> is
  the empty string and <a href="#final-mime-type">final MIME type</a> is
  <code>text/html</code>, return null.

  <p class="note">This is restricted to
  <code title="dom-XMLHttpRequest-responseType"><a href="#dom-xmlhttprequest-responsetype">responseType</a></code> being
  "<code title="">document</code>" in order to prevent breaking legacy
  content.

 <li>
  <p>If <a href="#final-mime-type">final MIME type</a> is <code>text/html</code>, run these
  substeps:

  <ol>
   <li><p>Let <var>charset</var> be the <a href="#final-charset">final charset</a>.

   <li><p>If <var>charset</var> is null,
   <a class="external" href="http://www.whatwg.org/specs/web-apps/current-work/multipage/parsing.html#prescan-a-byte-stream-to-determine-its-encoding" title="prescan a byte stream to determine its encoding">prescan</a>
   the first 1024 bytes of the <a href="#response-entity-body">response entity body</a> and if
   that does not terminate unsuccessfully then let <var>charset</var> be
   the return value.

   <li><p>If <var>charset</var> is null, set <var>charset</var> to
   <a class="external" href="http://encoding.spec.whatwg.org/#utf-8">utf-8</a>.

   <li><p>Let <var title="">document</var> be a
   <a class="external" href="http://dom.spec.whatwg.org/#concept-document" title="concept-document">document</a> that
   represents the result parsing <a href="#response-entity-body">response entity body</a> following the rules set
   forth in the HTML Standard for an HTML parser with scripting disabled and
   <a class="external" href="http://www.whatwg.org/specs/web-apps/current-work/multipage/parsing.html#a-known-definite-encoding">a known definite encoding</a> <var>charset</var>.
   <a href="#refsHTML">[HTML]</a>

   <li><p>Flag <var title="">document</var> as an
   <a class="external" href="http://dom.spec.whatwg.org/#html-document">HTML document</a>.
  </ol>

 <li>
  <p>Otherwise, let <var title="">document</var> be a
  <a class="external" href="http://dom.spec.whatwg.org/#concept-document" title="concept-document">document</a>
  that represents the result of parsing the
  <a href="#response-entity-body">response entity body</a> following the rules set forth in the
  XML specifications. If that fails (unsupported character encoding,
  namespace well-formedness error, etc.), return null.
  <a href="#refsXML">[XML]</a> <a href="#refsXMLNS">[XMLNS]</a>

  <p class="note">Scripts in the resulting document tree will not be
  executed, resources referenced will not be loaded and no associated XSLT
  will be applied. <!-- XXX more formally?! -->

 <li><p>If <var>charset</var> is null, set <var>charset</var> to
 <a class="external" href="http://encoding.spec.whatwg.org/#utf-8">utf-8</a>.
 <!-- can only happen in the XML case -->

 <li><p>Set <var title="">document</var>'s
 <a class="external" href="http://dom.spec.whatwg.org/#concept-document-encoding" title="concept-document-encoding">encoding</a> to
 <var>charset</var>.

 <li><p>Set <var title="">document</var>'s
 <a class="external" href="http://dom.spec.whatwg.org/#concept-document-content-type" title="concept-document-content-type">content type</a>
 to <a href="#final-mime-type">final MIME type</a>.

 <li><p>Set <var title="">document</var>'s
 <a class="external" href="http://dom.spec.whatwg.org/#concept-document-url" title="concept-document-url">URL</a> to
 <a href="#request-url">request URL</a>.

 <li><p>Set <var title="">document</var>'s <a class="external" href="http://www.whatwg.org/specs/web-apps/current-work/multipage/origin-0.html#origin">origin</a> to
 <a href="#source-origin">source origin</a>.

 <li><p>Return <var title="">document</var>.
</ol>

<p>The <dfn id="json-response-entity-body">JSON response entity body</dfn> is either a JavaScript value
representing the <a href="#response-entity-body">response entity body</a>. If the
<a href="#json-response-entity-body">JSON response entity body</a> is null, let it be return value of the following
algorithm:

<ol>
 <li><p>If the <a href="#response-entity-body">response entity body</a> is null, return null.

 <li><p>Let <var title="">JSON text</var> be the result of running
 <a class="external" href="http://encoding.spec.whatwg.org/#utf-8-decode">utf-8 decode</a> on byte stream
 <a href="#response-entity-body">response entity body</a>.

 <li><p>Return the result of invoking the initial value of the <code title="">parse</code>
 property of the <code title="">JSON</code> object defined in JavaScript, with
 <var title="">JSON text</var> as its only argument, or null if that function
 throws an exception. <a href="#refsECMASCRIPT">[ECMASCRIPT]</a>
</ol>


<p>The <dfn id="text-response-entity-body">text response entity body</dfn> is either a
string representing the <a href="#response-entity-body">response entity body</a> or null. If the
<a href="#text-response-entity-body">text response entity body</a> is null, let it be the return value of the
following algorithm:

<ol>
 <li><p>If the <a href="#response-entity-body">response entity body</a> is null, return the empty string.

 <li><p>Let <var>charset</var> be the <a href="#final-charset">final charset</a>.

 <li>
  <p>If <code title="dom-XMLHttpRequest-responseType"><a href="#dom-xmlhttprequest-responsetype">responseType</a></code> is
  the empty string, <var>charset</var> is null, and
  <a href="#final-mime-type">final MIME type</a> is either null, <code>text/xml</code>,
  <code>application/xml</code> or ends in <code title="">+xml</code>, use the
  rules set forth in the XML specifications to determine the encoding. Let
  <var>charset</var> be the determined encoding.
  <a href="#refsXML">[XML]</a> <a href="#refsXMLNS">[XMLNS]</a>

  <p class="note">This is restricted to
  <code title="dom-XMLHttpRequest-responseType"><a href="#dom-xmlhttprequest-responsetype">responseType</a></code> being
  the empty string to keep the non-legacy
  <code title="dom-XMLHttpRequest-responseType"><a href="#dom-xmlhttprequest-responsetype">responseType</a></code> value
  "<code title="">text</code>" simple.

 <li><p>If <var>charset</var> is null, set <var>charset</var> to
 <a class="external" href="http://encoding.spec.whatwg.org/#utf-8">utf-8</a>.

 <li><p>Return the result of running
 <a class="external" href="http://encoding.spec.whatwg.org/#decode">decode</a> on byte stream
 <a href="#response-entity-body">response entity body</a> using fallback encoding
 <var>charset</var>.
</ol>

<p class="note">Authors are strongly encouraged to always encode their
resources using <a class="external" href="http://encoding.spec.whatwg.org/#utf-8">utf-8</a>.



<h4 id="the-overridemimetype()-method"><span class="secno">4.6.6 </span>The <code title="">overrideMimeType()</code> method</h4>

<dl class="domintro">
 <dt><code><var title="">client</var> . <a href="#dom-xmlhttprequest-overridemimetype" title="dom-XMLHttpRequest-overrideMimeType">overrideMimeType</a>(<var title="">mime</var>)</code>
 <dd>
  <p>Sets the `<code title="">Content-Type</code>` header for <a href="#response-0">response</a> to
  <var title="">mime</var>.

  <p>Throws an "<code class="external"><a href="http://dom.spec.whatwg.org/#invalidstateerror">InvalidStateError</a></code>"
  exception if the state is
  <a href="#dom-xmlhttprequest-loading" title="dom-XMLHttpRequest-LOADING">LOADING</a> or
  <a href="#dom-xmlhttprequest-done" title="dom-XMLHttpRequest-DONE">DONE</a>.

  <p>Throws a "<code class="external"><a href="http://dom.spec.whatwg.org/#syntaxerror">SyntaxError</a></code>" exception if
  <var title="">mime</var> is not a valid MIME type.
 </dd>
</dl>

<p>The
<dfn id="dom-xmlhttprequest-overridemimetype" title="dom-XMLHttpRequest-overrideMimeType"><code>overrideMimeType(<var title="">mime</var>)</code></dfn>
method must run these steps:

<ol>
 <li><p>If the state is
 <a href="#dom-xmlhttprequest-loading" title="dom-XMLHttpRequest-LOADING">LOADING</a> or
 <a href="#dom-xmlhttprequest-done" title="dom-XMLHttpRequest-DONE">DONE</a>,
 <a class="external" href="http://dom.spec.whatwg.org/#concept-throw" title="concept-throw">throw</a> an
 "<code class="external"><a href="http://dom.spec.whatwg.org/#invalidstateerror">InvalidStateError</a></code>" exception.

 <li><p>If parsing <var title="">mime</var> analogously to the value of
 the `<code title="">Content-Type</code>` header fails,
 <a class="external" href="http://dom.spec.whatwg.org/#concept-throw" title="concept-throw">throw</a> a
 "<code class="external"><a href="http://dom.spec.whatwg.org/#syntaxerror">SyntaxError</a></code>" exception.

 <li><p>If <var title="">mime</var> is successfully parsed, set
 <a href="#override-mime-type">override MIME type</a> to its MIME type,
 excluding any parameters, and
 <a class="external" href="http://dom.spec.whatwg.org/#converted-to-ascii-lowercase">converted to ASCII lowercase</a>.

 <li><p>If a `<code title="">charset</code>` parameter is successfully parsed, set
 <a href="#override-charset">override charset</a> to its value.
</ol>



<h4 id="the-responsetype-attribute"><span class="secno">4.6.7 </span>The <code title="">responseType</code> attribute</h4>


<dl class="domintro">
 <dt><code><var title="">client</var> . <a href="#dom-xmlhttprequest-responsetype" title="dom-XMLHttpRequest-responseType">responseType</a></code> [ = <var>value</var> ]
 <dd>
  <p>Returns the response type.
  <p>Can be set to change the response type. Values are:
  the empty string (default),
  "<code title="">arraybuffer</code>",
  "<code title="">blob</code>",
  "<code title="">document</code>",
  "<code title="">json</code>", and
  "<code title="">text</code>".
  <p>When set: setting to "<code title="">document</code>" is ignored if the
  <a class="external" href="http://www.whatwg.org/specs/web-apps/current-work/multipage/infrastructure.html#javascript-global-environment">JavaScript global environment</a> is a
  <a class="external" href="http://www.whatwg.org/specs/web-apps/current-work/multipage/webappapis.html#worker-environment">worker environment</a>
  <p>When set: throws an
  "<code class="external"><a href="http://dom.spec.whatwg.org/#invalidstateerror">InvalidStateError</a></code>" exception if the
  state is <a href="#dom-xmlhttprequest-loading" title="dom-XMLHttpRequest-LOADING">LOADING</a> or
  <a href="#dom-xmlhttprequest-done" title="dom-XMLHttpRequest-DONE">DONE</a>.
  <p>When set: throws an
  "<code class="external"><a href="http://dom.spec.whatwg.org/#invalidaccesserror">InvalidAccessError</a></code>" exception if the
  <a href="#synchronous-flag">synchronous flag</a> is set and the
  <a class="external" href="http://www.whatwg.org/specs/web-apps/current-work/multipage/infrastructure.html#javascript-global-environment">JavaScript global environment</a> is a
  <a class="external" href="http://www.whatwg.org/specs/web-apps/current-work/multipage/webappapis.html#document-environment">document environment</a>.
</dl>


<p>The
<dfn id="dom-xmlhttprequest-responsetype" title="dom-XMLHttpRequest-responseType"><code>responseType</code></dfn>
attribute must return its value. Initially its value must be the empty
string.

<p>Setting the
<code title="dom-XMLHttpRequest-responseType"><a href="#dom-xmlhttprequest-responsetype">responseType</a></code>
attribute must run these steps:

<ol>
 <li><p>If the state is <a href="#dom-xmlhttprequest-loading" title="dom-XMLHttpRequest-LOADING">LOADING</a> or
 <a href="#dom-xmlhttprequest-done" title="dom-XMLHttpRequest-DONE">DONE</a>,
 <a class="external" href="http://dom.spec.whatwg.org/#concept-throw" title="concept-throw">throw</a> an
 "<code class="external"><a href="http://dom.spec.whatwg.org/#invalidstateerror">InvalidStateError</a></code>" exception.

 <li><p>If the
 <a class="external" href="http://www.whatwg.org/specs/web-apps/current-work/multipage/infrastructure.html#javascript-global-environment">JavaScript global environment</a> is a
 <a class="external" href="http://www.whatwg.org/specs/web-apps/current-work/multipage/webappapis.html#document-environment">document environment</a> and the
 <a href="#synchronous-flag">synchronous flag</a> is set,
 <a class="external" href="http://dom.spec.whatwg.org/#concept-throw" title="concept-throw">throw</a> an
 "<code class="external"><a href="http://dom.spec.whatwg.org/#invalidaccesserror">InvalidAccessError</a></code>" exception.

 <li><p>If the
 <a class="external" href="http://www.whatwg.org/specs/web-apps/current-work/multipage/infrastructure.html#javascript-global-environment">JavaScript global environment</a> is a
 <a class="external" href="http://www.whatwg.org/specs/web-apps/current-work/multipage/webappapis.html#worker-environment">worker environment</a> and the given
 value is "<code title="">document</code>", terminate these steps.

 <li><p>Set the
 <code title="dom-XMLHttpRequest-responseType"><a href="#dom-xmlhttprequest-responsetype">responseType</a></code>
 attribute's value to the given value.
</ol>




<h4 id="the-response-attribute"><span class="secno">4.6.8 </span>The <code title="">response</code> attribute</h4>

<dl class="domintro">
 <dt><code><var title="">client</var> . <a href="#dom-xmlhttprequest-response" title="dom-XMLHttpRequest-response">response</a></code>
 <dd><p>Returns the <a href="#response-entity-body">response entity body</a>.
</dl>

<p>The
<dfn id="dom-xmlhttprequest-response" title="dom-XMLHttpRequest-response"><code>response</code></dfn>
attribute must return the result of running these
steps:

<dl class="switch">
 <dt>If <code title="dom-XMLHttpRequest-responseType"><a href="#dom-xmlhttprequest-responsetype">responseType</a></code>
 is the empty string or "<code title="">text</code>"</dt>
 <dd>
  <ol>
   <li><p>If the state is not <a href="#dom-xmlhttprequest-loading" title="dom-XMLHttpRequest-LOADING">LOADING</a> or
   <a href="#dom-xmlhttprequest-done" title="dom-XMLHttpRequest-DONE">DONE</a>, return the empty string.

   <li><p>Return the <a href="#text-response-entity-body">text response entity body</a>.
  </ol>

 <dt>Otherwise</dt>
 <dd>
  <ol>
   <li><p>If the state is not <a href="#dom-xmlhttprequest-done" title="dom-XMLHttpRequest-DONE">DONE</a>, return
   null.

   <li>
    <dl class="switch">
     <dt>If
     <code title="dom-XMLHttpRequest-responseType"><a href="#dom-xmlhttprequest-responsetype">responseType</a></code> is
     "<code title="">arraybuffer</code>"</dt>
     <dd><p>Return the
     <a href="#arraybuffer-response-entity-body">arraybuffer response entity body</a>.</dd>

     <dt>If
     <code title="dom-XMLHttpRequest-responseType"><a href="#dom-xmlhttprequest-responsetype">responseType</a></code> is
     "<code title="">blob</code>"</dt>
     <dd><p>Return the
     <a href="#blob-response-entity-body">blob response entity body</a>.</dd>

     <dt>If
     <code title="dom-XMLHttpRequest-responseType"><a href="#dom-xmlhttprequest-responsetype">responseType</a></code> is
     "<code title="">document</code>"</dt>
     <dd><p>Return the
     <a href="#document-response-entity-body">document response entity body</a>.</dd>

     <dt>If
     <code title="dom-XMLHttpRequest-responseType"><a href="#dom-xmlhttprequest-responsetype">responseType</a></code> is
     "<code title="">json</code>"</dt>
     <dd><p>Return the
     <a href="#json-response-entity-body">JSON response entity body</a>.</dd>
    </dl>
  </ol>
</dl>



<h4 id="the-responsetext-attribute"><span class="secno">4.6.9 </span>The <code title="">responseText</code> attribute</h4>

<dl class="domintro">
 <dt><code><var title="">client</var> . <a href="#dom-xmlhttprequest-responsetext" title="dom-XMLHttpRequest-responseText">responseText</a></code>
 <dd>
  <p>Returns the <a href="#text-response-entity-body">text response entity body</a>.

  <p>Throws an "<code class="external"><a href="http://dom.spec.whatwg.org/#invalidstateerror">InvalidStateError</a></code>"
  exception if
  <code title="dom-XMLHttpRequest-responseType"><a href="#dom-xmlhttprequest-responsetype">responseType</a></code> is not
  the empty string or "<code title="">text</code>".
</dl>

<p>The
<dfn id="dom-xmlhttprequest-responsetext" title="dom-XMLHttpRequest-responseText"><code>responseText</code></dfn>
attribute must return the result of running these
steps:

<ol>

 <li><p>If <code title="dom-XMLHttpRequest-responseType"><a href="#dom-xmlhttprequest-responsetype">responseType</a></code> is not the
 empty string or "<code title="">text</code>",
 <a class="external" href="http://dom.spec.whatwg.org/#concept-throw" title="concept-throw">throw</a> an
 "<code class="external"><a href="http://dom.spec.whatwg.org/#invalidstateerror">InvalidStateError</a></code>" exception.


 <li><p>If the state is not <a href="#dom-xmlhttprequest-loading" title="dom-XMLHttpRequest-LOADING">LOADING</a> or
 <a href="#dom-xmlhttprequest-done" title="dom-XMLHttpRequest-DONE">DONE</a>, return the empty string.

 <li><p>Return the <a href="#text-response-entity-body">text response entity body</a>.
</ol>


<h4 id="the-responsexml-attribute"><span class="secno">4.6.10 </span>The <code title="">responseXML</code> attribute</h4>

<dl class="domintro">
 <dt><code><var title="">client</var> . <a href="#dom-xmlhttprequest-responsexml" title="dom-XMLHttpRequest-responseXML">responseXML</a></code>
 <dd>
  <p>Returns the <a href="#document-response-entity-body">document response entity body</a>.

  <p>Throws an "<code class="external"><a href="http://dom.spec.whatwg.org/#invalidstateerror">InvalidStateError</a></code>"
  exception if
  <code title="dom-XMLHttpRequest-responseType"><a href="#dom-xmlhttprequest-responsetype">responseType</a></code> is not
  the empty string or "<code title="">document</code>".
</dl>

<p>The
<dfn id="dom-xmlhttprequest-responsexml" title="dom-XMLHttpRequest-responseXML"><code>responseXML</code></dfn>
attribute must return the result of running these steps:

<ol>
 <li><p>If
 <code title="dom-XMLHttpRequest-responseType"><a href="#dom-xmlhttprequest-responsetype">responseType</a></code> is not
 the empty string or "<code title="">document</code>",
 <a class="external" href="http://dom.spec.whatwg.org/#concept-throw" title="concept-throw">throw</a> an
 "<code class="external"><a href="http://dom.spec.whatwg.org/#invalidstateerror">InvalidStateError</a></code>" exception.


 <li><p>If the state is not <a href="#dom-xmlhttprequest-done" title="dom-XMLHttpRequest-DONE">DONE</a>, return
 null.

 <li><p>Return the <a href="#document-response-entity-body">document response entity body</a>.
</ol>

<p class="note">The
<code title="dom-XMLHttpRequest-responseXML"><a href="#dom-xmlhttprequest-responsexml">responseXML</a></code> attribute
has XML in its name for historical reasons. It also returns HTML resources
as <a class="external" href="http://dom.spec.whatwg.org/#concept-document" title="concept-document">documents</a>.


<h3 id="events"><span class="secno">4.7 </span>Events summary</h3>

<p><em>This section is non-normative.</em>

<p>The following events are dispatched on <code><a href="#xmlhttprequest">XMLHttpRequest</a></code>
and/or <code><a href="#xmlhttprequestupload">XMLHttpRequestUpload</a></code> objects:

<table>
 <thead>
  <tr>
   <th>Event name</th>
   <th>Interface</th>
   <th>Dispatched when…</th>
 <tbody>
  <tr>
   <td><dfn id="event-xhr-readystatechange" title="event-xhr-readystatechange"><code>readystatechange</code></dfn></td>
   <td><code class="external"><a href="http://dom.spec.whatwg.org/#event">Event</a></code></td>
   <td>The <code title="dom-XMLHttpRequest-readyState"><a href="#dom-xmlhttprequest-readystate">readyState</a></code> attribute changes
   value, except when it changes to <a href="#dom-xmlhttprequest-unsent" title="dom-XMLHttpRequest-UNSENT">UNSENT</a>.
  <tr>
   <td><dfn id="event-xhr-loadstart" title="event-xhr-loadstart"><code>loadstart</code></dfn></td>
   <td><code><a href="#progressevent">ProgressEvent</a></code></td>
   <td>The fetch initiates.
  <tr>
   <td><dfn id="event-xhr-progress" title="event-xhr-progress"><code>progress</code></dfn></td>
   <td><code><a href="#progressevent">ProgressEvent</a></code></td>
   <td>Transmitting data.
  <tr>
   <td><dfn id="event-xhr-abort" title="event-xhr-abort"><code>abort</code></dfn></td>
   <td><code><a href="#progressevent">ProgressEvent</a></code></td>
   <td>When the fetch has been aborted. For instance, by invoking the
   <code title="dom-XMLHttpRequest-abort"><a href="#dom-xmlhttprequest-abort">abort()</a></code> method.</td>
  <tr>
   <td><dfn id="event-xhr-error" title="event-xhr-error"><code>error</code></dfn></td>
   <td><code><a href="#progressevent">ProgressEvent</a></code></td>
   <td>The fetch failed.
  <tr>
   <td><dfn id="event-xhr-load" title="event-xhr-load"><code>load</code></dfn></td>
   <td><code><a href="#progressevent">ProgressEvent</a></code></td>
   <td>The fetch succeeded.
  <tr>
   <td><dfn id="event-xhr-timeout" title="event-xhr-timeout"><code>timeout</code></dfn></td>
   <td><code><a href="#progressevent">ProgressEvent</a></code></td>
   <td>The author specified timeout has passed before the fetch completed.
  <tr>
   <td><dfn id="event-xhr-loadend" title="event-xhr-loadend"><code>loadend</code></dfn></td>
   <td><code><a href="#progressevent">ProgressEvent</a></code></td>
   <td>The fetch completed (success or failure).
</table>



<h2 id="interface-formdata"><span class="secno">5 </span>Interface <code title="">FormData</code></h2>

<pre class="idl">typedef (<a class="external" href="http://dev.w3.org/2006/webapi/FileAPI/#file">File</a> or [EnsureUTF16] DOMString) <dfn id="formdataentryvalue">FormDataEntryValue</dfn>;

[<a href="#dom-formdata" title="dom-FormData">Constructor</a>(optional <a class="external" href="http://www.whatwg.org/specs/web-apps/current-work/multipage/forms.html#htmlformelement">HTMLFormElement</a> <var>form</var>)]
interface <dfn id="formdata">FormData</dfn> {
  void <a href="#dom-formdata-append" title="dom-FormData-append">append</a>([EnsureUTF16] DOMString <var>name</var>, <a class="external" href="http://dev.w3.org/2006/webapi/FileAPI/#blob">Blob</a> <var>value</var>, optional [EnsureUTF16] DOMString <var>filename</var>);
  void <a href="#dom-formdata-append" title="dom-FormData-append">append</a>([EnsureUTF16] DOMString <var>name</var>, [EnsureUTF16] DOMString <var>value</var>);
  void <a href="#dom-formdata-delete" title="dom-FormData-delete">delete</a>([EnsureUTF16] DOMString <var>name</var>);
  <a href="#formdataentryvalue">FormDataEntryValue</a>? <a href="#dom-formdata-get" title="dom-FormData-get">get</a>([EnsureUTF16] DOMString <var>name</var>);
  sequence&lt;<a href="#formdataentryvalue">FormDataEntryValue</a>&gt; <a href="#dom-formdata-getall" title="dom-FormData-getAll">getAll</a>([EnsureUTF16] DOMString <var>name</var>);
  boolean <a href="#dom-formdata-has" title="dom-FormData-has">has</a>([EnsureUTF16] DOMString <var>name</var>);
  void <a href="#dom-formdata-append" title="dom-FormData-append">set</a>([EnsureUTF16] DOMString <var>name</var>, <a class="external" href="http://dev.w3.org/2006/webapi/FileAPI/#blob">Blob</a> <var>value</var>, optional [EnsureUTF16] DOMString <var>filename</var>);
  void <a href="#dom-formdata-set" title="dom-FormData-set">set</a>([EnsureUTF16] DOMString <var>name</var>, [EnsureUTF16] DOMString <var>value</var>);
};</pre>

<p>If the <a class="external" href="http://www.whatwg.org/specs/web-apps/current-work/multipage/infrastructure.html#javascript-global-environment">JavaScript global environment</a> is a
<a class="external" href="http://www.whatwg.org/specs/web-apps/current-work/multipage/webappapis.html#worker-environment">worker environment</a>, <code><a href="#formdata">FormData</a></code> must be
<a class="external" href="http://www.whatwg.org/specs/web-apps/current-work/multipage/infrastructure.html#exposed-to-javascript">exposed to JavaScript</a> as if the constructor part of the
IDL reads <code title="">[Constructor]</code> (i.e. has no arguments).
<!-- maybe move this into IDL at some point -->

<p>The <code><a href="#formdata">FormData</a></code> object represents an ordered list of
<dfn id="concept-formdata-entry" title="concept-FormData-entry">entries</dfn>. Each
<a href="#concept-formdata-entry" title="concept-FormData-entry">entry</a> consists of a
<dfn id="concept-formdata-entry-name" title="concept-FormData-entry-name">name</dfn> and a
<dfn id="concept-formdata-entry-value" title="concept-FormData-entry-value">value</dfn>.

<p>For the purposes of interaction with other algorithms, an
<a href="#concept-formdata-entry" title="concept-FormData-entry">entry</a>'s type is "string" if
<a href="#concept-formdata-entry-value" title="concept-FormData-entry-value">value</a> is a string and "file" otherwise. If
an <a href="#concept-formdata-entry" title="concept-FormData-entry">entry</a>'s type is "file", its filename is the
value of <a href="#concept-formdata-entry" title="concept-FormData-entry">entry</a>'s
<a href="#concept-formdata-entry-value" title="concept-FormData-entry-value">value</a>'s
<code class="external" title="dom-File-name"><a href="http://dev.w3.org/2006/webapi/FileAPI/#dfn-name">name</a></code> attribute.

<p>To <dfn id="create-an-entry">create an entry</dfn> for <var>name</var>, <var>value</var>, and optionally a
<var>filename</var>, run these steps:

<ol>
 <li><p>Let <var>entry</var> be a new
 <a href="#concept-formdata-entry" title="concept-FormData-entry">entry</a>.

 <li><p>Set <var>entry</var>'s <a href="#concept-formdata-entry-name" title="concept-FormData-entry-name">name</a>
 to <var>name</var>.

 <li><p>If <var>value</var> is a <code class="external"><a href="http://dev.w3.org/2006/webapi/FileAPI/#blob">Blob</a></code>, set
 <var>value</var> to a new <code class="external"><a href="http://dev.w3.org/2006/webapi/FileAPI/#file">File</a></code> object whose
 <code class="external" title="dom-File-name"><a href="http://dev.w3.org/2006/webapi/FileAPI/#dfn-name">name</a></code> attribute value is
 "<code title="">blob</code>".

 <li><p>If <var>value</var> is a <code class="external"><a href="http://dev.w3.org/2006/webapi/FileAPI/#file">File</a></code> and
 <var title="">filename</var> is given, set <var>value</var>'s
 <code class="external" title="dom-File-name"><a href="http://dev.w3.org/2006/webapi/FileAPI/#dfn-name">name</a></code> attribute value to
 <var>filename</var>.

 <li><p>Set <var>entry</var>'s <a href="#concept-formdata-entry-value" title="concept-FormData-entry-value">value</a> to
 <var>value</var>.

 <li><p>Return <var>entry</var>.
</ol>


<p>The
<dfn id="dom-formdata" title="dom-FormData"><code>FormData(<var>form</var>)</code></dfn>
constructor must run these steps:

<ol>
 <li><p>Let <var title="">fd</var> be a new <code><a href="#formdata">FormData</a></code> object.

 <li><p>If <var>form</var> is given, set <var title="">fd</var>'s
 <a href="#concept-formdata-entry" title="concept-FormData-entry">entries</a> to the result of
 <a class="external" href="http://www.whatwg.org/specs/web-apps/current-work/multipage/association-of-controls-and-forms.html#constructing-form-data-set">constructing the form data set</a> for <var>form</var>.

 <li><p>Return <var title="">fd</var>.
</ol>

<p>The
<dfn id="dom-formdata-append" title="dom-FormData-append"><code>append(<var>name</var>, <var>value</var>, <var>filename</var>)</code></dfn>
method must run these steps:

<ol>
 <li><p>Let <var title="">entry</var> be the result of <a href="#create-an-entry">create an entry</a> with
 <var>name</var>, <var>value</var>, and <var>filename</var> if given.

 <li><p>Append <var title="">entry</var> to <code><a href="#formdata">FormData</a></code> object's list of
 <a href="#concept-formdata-entry" title="concept-FormData-entry">entries</a>.
</ol>

<p>The
<dfn id="dom-formdata-delete" title="dom-FormData-delete"><code>delete(<var>name</var>)</code></dfn>
method must remove all <a href="#concept-formdata-entry" title="concept-FormData-entry">entries</a> whose
<a href="#concept-formdata-entry-name" title="concept-FormData-entry-name">name</a> is <var>name</var>.

<p>The
<dfn id="dom-formdata-get" title="dom-FormData-get"><code>get(<var>name</var>)</code></dfn>
method must return the <a href="#concept-formdata-entry-value" title="concept-FormData-entry-value">value</a> of the first
<a href="#concept-formdata-entry" title="concept-FormData-entry">entry</a> whose
<a href="#concept-formdata-entry-name" title="concept-FormData-entry-name">name</a> is <var>name</var>, and null
otherwise.

<p>The
<dfn id="dom-formdata-getall" title="dom-FormData-getAll"><code>getAll(<var>name</var>)</code></dfn>
method must return the <a href="#concept-formdata-entry-value" title="concept-FormData-entry-value">values</a> of all
<a href="#concept-formdata-entry" title="concept-FormData-entry">entries</a> whose
<a href="#concept-formdata-entry-name" title="concept-FormData-entry-name">name</a> is <var>name</var>, in list
order, and the empty sequence otherwise.

<p>The
<dfn id="dom-formdata-set" title="dom-FormData-set"><code>set(<var>name</var>, <var>value</var>)</code></dfn>
method must run these steps:

<ol>
 <li><p>Let <var>entry</var> be the result of <a href="#create-an-entry">create an entry</a> with
 <var>name</var>, <var>value</var>, and <var>filename</var> if given.

 <li><p>If there are any <a href="#concept-formdata-entry" title="concept-FormData-entry">entries</a> whose
 <a href="#concept-formdata-entry-name" title="concept-FormData-entry-name">name</a> is <var>name</var>, replace
 the first such <a href="#concept-formdata-entry" title="concept-FormData-entry">entry</a> with <var>entry</var> and
 remove the others.

 <li><p>Otherwise, append <var>entry</var> to <code><a href="#formdata">FormData</a></code> object's list of
 <a href="#concept-formdata-entry" title="concept-FormData-entry">entries</a>.
</ol>

<p>The <dfn id="dom-formdata-has" title="dom-FormData-has"><code>has(<var>name</var>)</code></dfn> method must
return true if there is an <a href="#concept-formdata-entry" title="concept-FormData-entry">entry</a> whose
<a href="#concept-formdata-entry-name" title="concept-FormData-entry-name">name</a> is <var>name</var>, and false
otherwise.



<h2 id="interface-progressevent"><span class="secno">6 </span>Interface <code title="">ProgressEvent</code></h2>

<pre class="idl">[Constructor(DOMString <var title="">type</var>, optional <a href="#progresseventinit">ProgressEventInit</a> <var title="">eventInitDict</var>)]
interface <dfn id="progressevent">ProgressEvent</dfn> : <a class="external" href="http://dom.spec.whatwg.org/#event">Event</a> {
  readonly attribute boolean <a href="#dom-progressevent-lengthcomputable" title="dom-ProgressEvent-lengthComputable">lengthComputable</a>;
  readonly attribute unsigned long long <a href="#dom-progressevent-loaded" title="dom-ProgressEvent-loaded">loaded</a>;
  readonly attribute unsigned long long <a href="#dom-progressevent-total" title="dom-ProgressEvent-total">total</a>;
};

dictionary <dfn id="progresseventinit">ProgressEventInit</dfn> : <a class="external" href="http://dom.spec.whatwg.org/#eventinit">EventInit</a> {
  boolean <span title="dom-ProgressEventInit-lengthComputable">lengthComputable</span>;
  unsigned long long <span title="dom-ProgressEventInit-loaded">loaded</span>;
  unsigned long long <span title="dom-ProgressEventInit-total">total</span>;
}</pre>

<p><a class="external" href="http://dom.spec.whatwg.org/#concept-event" title="concept-event">Events</a> using
the <code><a href="#progressevent">ProgressEvent</a></code> interface indicate some kind of
progression.

<p>The
<dfn id="dom-progressevent-lengthcomputable" title="dom-ProgressEvent-lengthComputable"><code>lengthComputable</code></dfn>
attribute must return the value it was initialized to. When an
<a class="external" href="http://dom.spec.whatwg.org/#concept-event" title="concept-event">event</a> is created
the attribute must be initialized to false.

<p>The
<dfn id="dom-progressevent-loaded" title="dom-ProgressEvent-loaded"><code>loaded</code></dfn> and
<dfn id="dom-progressevent-total" title="dom-ProgressEvent-total"><code>total</code></dfn>
attributes must return the value they were initialized to. When an
<a class="external" href="http://dom.spec.whatwg.org/#concept-event" title="concept-event">event</a> is created
the attributes must be initialized to 0.


<h3 id="firing-events-using-the-progressevent-interface-for-fetch"><span class="secno">6.1 </span>Firing events using the <code title="">ProgressEvent</code> interface for Fetch</h3>

<p>To
<dfn id="concept-event-fire-upload-progress" title="concept-event-fire-upload-progress">fire an upload progress event named <var>e</var></dfn>
means to
<a class="external" href="http://dom.spec.whatwg.org/#concept-event-fire" title="concept-event-fire">fire an event named <var>e</var></a>
with an <a class="external" href="http://dom.spec.whatwg.org/#concept-event" title="concept-event">event</a>
using the <code><a href="#progressevent">ProgressEvent</a></code> interface that also meets these
conditions:

<ul>
 <li>Initialize the <code title="dom-ProgressEvent-loaded"><a href="#dom-progressevent-loaded">loaded</a></code>
 attribute to the length of
 <a class="external" href="http://fetch.spec.whatwg.org/#concept-request" title="concept-request">request</a>'s
 <a class="external" href="http://fetch.spec.whatwg.org/#concept-request-body" title="concept-request-body">body</a>.
 <li>If the length of
 <a class="external" href="http://fetch.spec.whatwg.org/#concept-request" title="concept-request">response</a>'s
 <a class="external" href="http://fetch.spec.whatwg.org/#concept-request-body" title="concept-request-body">body</a> is known through the
 <code class="external" title="http-content-length"><a href="http://tools.ietf.org/html/rfc2616/#section-14.13">Content-Length</a></code> header,
 set the <code title="dom-ProgressEvent-lengthComputable"><a href="#dom-progressevent-lengthcomputable">lengthComputable</a></code> attribute
 value to true and the <code title="dom-ProgressEvent-total"><a href="#dom-progressevent-total">total</a></code> attribute value to
 the length.
</ul>

<p>To
<dfn id="concept-event-fire-progress" title="concept-event-fire-progress">fire a progress event named <var>e</var></dfn>
means to
<a class="external" href="http://dom.spec.whatwg.org/#concept-event-fire" title="concept-event-fire">fire an event named <var>e</var></a>
with an <a class="external" href="http://dom.spec.whatwg.org/#concept-event" title="concept-event">event</a>
using the <code><a href="#progressevent">ProgressEvent</a></code> interface that also meets these
conditions:

<ul>
 <li>Initialize the <code title="dom-ProgressEvent-loaded"><a href="#dom-progressevent-loaded">loaded</a></code>
 attribute to the length of
 <a class="external" href="http://fetch.spec.whatwg.org/#concept-response" title="concept-response">response</a>'s
 <a class="external" href="http://fetch.spec.whatwg.org/#concept-response-body" title="concept-response-body">body</a>.
 <li>If the length of
 <a class="external" href="http://fetch.spec.whatwg.org/#concept-response" title="concept-response">response</a>'s
 <a class="external" href="http://fetch.spec.whatwg.org/#concept-response-body" title="concept-response-body">body</a> is known through the
 <code class="external" title="http-content-length"><a href="http://tools.ietf.org/html/rfc2616/#section-14.13">Content-Length</a></code> header,
 set the <code title="dom-ProgressEvent-lengthComputable"><a href="#dom-progressevent-lengthcomputable">lengthComputable</a></code> attribute
 value to true and the <code title="dom-ProgressEvent-total"><a href="#dom-progressevent-total">total</a></code> attribute value to
 the length.
</ul>


<h3 id="firing-events-using-the-progressevent-interface-for-other-contexts"><span class="secno">6.2 </span>Firing events using the <code title="">ProgressEvent</code> interface for other contexts</h3>

<p>This is left as an exercise for the editor of the specification that
introduces such a context. The editor is encouraged to define it in a way
consistent with this and other specifications that utilize
<a class="external" href="http://dom.spec.whatwg.org/#concept-event" title="concept-event">events</a> using the
<code><a href="#progressevent">ProgressEvent</a></code> interface.


<h3 id="suggested-names-for-events-using-the-progressevent-interface"><span class="secno">6.3 </span>Suggested names for events using the <code title="">ProgressEvent</code> interface</h3>

<p><em>This section is non-normative.</em>

<p>The suggested <code class="external" title="dom-Event-type"><a href="http://dom.spec.whatwg.org/#dom-event-type">type</a></code>
attribute values for use with
<a class="external" href="http://dom.spec.whatwg.org/#concept-event" title="concept-event">events</a> using the
<code><a href="#progressevent">ProgressEvent</a></code> interface are summarized in the table below.
Specification editors are free to tune the details to their specific
scenarios, though are strongly encouraged to discuss their usage with the
WHATWG community to ensure input from people familiar with the subject.

<table>
 <tbody>
  <tr>
   <th><code class="external" title="dom-Event-type"><a href="http://dom.spec.whatwg.org/#dom-event-type">type</a></code> attribute value
   <th>Description
   <th>Times
   <th>When
  <tr>
   <th><code title="">loadstart</code>
   <td>Progress has begun.
   <td>Once.
   <td>First.
  <tr>
   <th><code title="">progress</code>
   <td>In progress.
   <td>Zero or more.
   <td>After <code title="">loadstart</code> has been
    <a class="external" href="http://dom.spec.whatwg.org/#concept-event-dispatch" title="concept-event-dispatch">dispatched</a>.
  <tr>
   <th><code title="">error</code>
   <td>Progression failed.
   <td>Zero or once.
   <td rowspan="3">After the last <code title="">progress</code> has
    been
    <a class="external" href="http://dom.spec.whatwg.org/#concept-event-dispatch" title="concept-event-dispatch">dispatched</a>,
    or after <code title="">loadstart</code> has been
    <a class="external" href="http://dom.spec.whatwg.org/#concept-event-dispatch" title="concept-event-dispatch">dispatched</a>
    if <code title="">progress</code> has not been
    <a class="external" href="http://dom.spec.whatwg.org/#concept-event-dispatch" title="concept-event-dispatch">dispatched</a>.
  <tr>
   <th><code>abort</code>
   <td>Progression is terminated.
   <td>Zero or once.
  <tr>
   <th><code>load</code>
   <td>Progression is successful.
   <td>Zero or once.
  <tr>
   <th><code title="">loadend</code>
   <td>Progress has stopped.
   <td>Once.</td>
   <td>After one of <code title="">error</code>,
    <code title="">abort</code>, or <code title="">load</code> has been
    <a class="external" href="http://dom.spec.whatwg.org/#concept-event-dispatch" title="concept-event-dispatch">dispatched</a>.
</table>

<p>The <code title="">error</code>, <code title="">abort</code>, and
<code title="">load</code> event types are mutually exclusive.

<p>Throughout the web platform the <code title="">error</code>,
<code title="">abort</code>, and <code title="">load</code> event types have
their <code class="external" title="dom-Event-bubbles"><a href="http://dom.spec.whatwg.org/#dom-event-bubbles">bubbles</a></code> and
<code class="external" title="dom-Event-cancelable"><a href="http://dom.spec.whatwg.org/#dom-event-cancelable">cancelable</a></code>
attributes initialized to false, so it is suggested that for consistency all
<a class="external" href="http://dom.spec.whatwg.org/#concept-event" title="concept-event">events</a> using the
<code><a href="#progressevent">ProgressEvent</a></code> interface do the same.


<h3 id="security-considerations"><span class="secno">6.4 </span>Security Considerations</h3>

<p>For cross-origin requests some kind of opt-in, e.g. the
<a class="external" href="http://fetch.spec.whatwg.org/#cors-protocol">CORS protocol</a> defined in the Fetch Standard, has to be
used before <a class="external" href="http://dom.spec.whatwg.org/#concept-event" title="concept-event">events</a> using the
<code><a href="#progressevent">ProgressEvent</a></code> interface are
<a class="external" href="http://dom.spec.whatwg.org/#concept-event-dispatch" title="concept-event-dispatch">dispatched</a>
as information (e.g. size) would be revealed that cannot be obtained
otherwise. <a class="informative" href="#refsFETCH">[FETCH]</a>


<h3 id="example"><span class="secno">6.5 </span>Example</h3>

<div class="example">
 <p>In this example <code><a href="#xmlhttprequest">XMLHttpRequest</a></code>, combined with concepts
 defined in the sections before, and the HTML
 <code class="external"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/the-button-element.html#the-progress-element">progress</a></code> element are used together to
 display the process of
 <a class="external" href="http://fetch.spec.whatwg.org/#concept-fetch" title="concept-fetch">fetching</a> a resource.

 <pre>&lt;!DOCTYPE html&gt;
&lt;title&gt;Waiting for Magical Unicorns&lt;/title&gt;
&lt;progress id=p&gt;&lt;/progress&gt;
&lt;script&gt;
  var progressBar = document.getElementById("p"),
      client = new XMLHttpRequest()
  client.open("GET", "magical-unicorns")
  client.onprogress = function(pe) {
    if(pe.lengthComputable) {
      progressBar.max = pe.total
      progressBar.value = pe.loaded
    }
  }
  client.onloadend = function(pe) {
    progressBar.value = pe.loaded
  }
  client.send()
&lt;/script&gt;</pre>

 <p>Fully working code would of course be more elaborate and deal with more
 scenarios, such as network errors or the end user terminating the request.
</div>



<h2 class="no-num" id="references">References</h2>
<div id="anolis-references"><dl><dt id="refsCOOKIES">[COOKIES]
<dd><cite><a href="http://tools.ietf.org/html/rfc6265">HTTP State Management Mechanism</a></cite>, Adam Barth. IETF.

<dt id="refsDOM">[DOM]
<dd><cite><a href="http://dom.spec.whatwg.org/">DOM</a></cite>, Anne van Kesteren, Aryeh Gregor and Ms2ger. WHATWG.

<dt id="refsDOMPS">[DOMPS]
<dd><cite><a href="http://domparsing.spec.whatwg.org/">DOM Parsing and Serialization</a></cite>, Ms2ger. WHATWG.

<dt id="refsECMASCRIPT">[ECMASCRIPT]
<dd><cite><a href="http://www.ecma-international.org/publications/standards/Ecma-262.htm">ECMAScript Language Specification</a></cite>. ECMA.

<dt id="refsENCODING">[ENCODING]
<dd><cite><a href="http://encoding.spec.whatwg.org/">Encoding</a></cite>, Anne van Kesteren. WHATWG.

<dt id="refsFETCH">[FETCH]
<dd><cite><a href="http://fetch.spec.whatwg.org/">Fetch</a></cite>, Anne van Kesteren. WHATWG.

<dt id="refsFILEAPI">[FILEAPI]
<dd><cite><a href="http://dev.w3.org/2006/webapi/FileAPI/">File API</a></cite>, Arun Ranganathan and Jonas Sicking. W3C.

<dt id="refsHTML">[HTML]
<dd><cite><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/">HTML</a></cite>, Ian Hickson. WHATWG.

<dt id="refsHTTP">[HTTP]
<dd><cite><a href="http://tools.ietf.org/html/rfc2616">Hypertext Transfer Protocol -- HTTP/1.1</a></cite>, Roy Fielding, James Gettys, Jeffrey Mogul et al.. IETF.

<dt id="refsRFC2119">[RFC2119]
<dd><cite><a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a></cite>, Scott Bradner. IETF.

<dt id="refsTYPEDARRAY">[TYPEDARRAY]
<dd><cite><a href="http://www.khronos.org/registry/typedarray/specs/latest/">Typed Array</a></cite>, David Herman and Kenneth Russell. Khronos.

<dt id="refsURL">[URL]
<dd><cite><a href="http://url.spec.whatwg.org/">URL</a></cite>, Anne van Kesteren. WHATWG.

<dt id="refsWEBIDL">[WEBIDL]
<dd><cite><a href="http://dev.w3.org/2006/webapi/WebIDL/">Web IDL</a></cite>, Cameron McCormack. W3C.

<dt id="refsXML">[XML]
<dd><cite><a href="http://www.w3.org/TR/xml/">Extensible Markup Language</a></cite>, Tim Bray, Jean Paoli, C. M. Sperberg-McQueen et al.. W3C.

<dt id="refsXMLNS">[XMLNS]
<dd><cite><a href="http://www.w3.org/TR/xml-names/">Namespaces in XML</a></cite>, Tim Bray, Dave Hollander, Andrew Layman et al.. W3C.

</dl></div>



<h2 class="no-num" id="acknowledgments">Acknowledgments</h2>

<p>The editor would like to thank

Addison Phillips,
Adrian Bateman,
Ahmed Kamel,
Alex Hopmann,
Alex Vincent,
Alexey Proskuryakov,
Andrea Marchesini,
Asbjørn Ulsberg,
Boris Zbarsky,
Björn Höhrmann,
Cameron McCormack,
Chris Marrin,
Christophe Jolif,
Charles McCathieNevile,
Dan Winship,
David Andersson,
David Flanagan,
David Håsäther,
David Levin,
Dean Jackson,
Denis Sureau,
Dominik Röttsches,
Doug Schepers,
Douglas Livingstone,
Elliott Sprehn,
Elliotte Harold,
Eric Lawrence,
Eric Uhrhane,
Erik Arvidsson,
Erik Dahlström,
Feras Moussa,
Geoffrey Sneddon,
Gideon Cohn,
Glenn Adams,
Gorm Haug Eriksen,
Håkon Wium Lie,
Hallvord R. M. Steen,
Henri Sivonen,
Huub Schaeks,
Ian Davis,
Ian Hickson,
Ivan Herman,
Jarred Nicholls,
Jeff Walden,
Jens Lindström,
Jim Deegan,
Jim Ley,
Joe Farro,
Jonas Sicking,
Julian Reschke,
송정기 (Jungkee Song),
呂康豪 (Kang-Hao Lu),
Karl Dubost,
Lachlan Hunt,
Maciej Stachowiak,
Magnus Kristiansen,
Marc Hadley,
Marcos Caceres,
Mark Baker,
Mark Birbeck,
Mark Nottingham,
Mark S. Miller,
Martin Hassman,
Mohamed Zergaoui,
Ms2ger,
Odin Hørthe Omdal,
Olli Pettay,
Pawel Glowacki,
Peter Michaux,
Philip Taylor,
Robin Berjon,
Rune <span title="Fabulous">F.</span> Halvorsen,
Ruud Steltenpool,
Sergiu Dumitriu,
Sigbjørn Finne,
Simon Pieters,
Stewart Brodie,
Sunava Dutta,
Takeshi Yoshino,
Thomas Roessler,
Tom Magliery,
Travis Leithead,
Yehuda Katz, and
Zhenbin Xu

for their contributions to this specification.

<p>Special thanks to the Microsoft employees who first implemented the
<code title="">XMLHttpRequest</code> interface, which was first widely
deployed by the Windows Internet Explorer browser.

<p>Special thanks also to the WHATWG for drafting an initial version of
this specification in their Web Applications 1.0 document (now renamed to
HTML). <a href="#refsHTML">[HTML]</a>

<p>Special thanks to the SVG WG for drafting the original
<code title="">ProgressEvent</code> interface as part of the
<a href="http://www.w3.org/TR/2008/REC-SVGTiny12-20081222/svgudom.html">SVG Micro DOM</a>.

<p>Thanks also to all those who have helped to improve this specification by
sending suggestions and corrections. (Please, keep bugging us with your
issues!)

<script id="head" src="http://www.whatwg.org/specs/web-apps/current-work/dfn.js"></script>
